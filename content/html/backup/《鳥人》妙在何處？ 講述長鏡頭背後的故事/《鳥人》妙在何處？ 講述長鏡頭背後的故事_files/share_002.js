var MtimeShareRelatedObjectTypes={Movie:1,Person:2,UserPhoto:5,Blog:6,Group:9,ForumTopic:10,MoviePicture:11,PersonPicture:21,Activity:22,Cinema:33,Video:41,List:50,CMSNews:51,CMSGalleryImage:52,Twitter:54,CMSSpecialTopic:59,GameVote:63,Link:64,GameQuiz:67,Festival:82,FestivalEvent:83,CommunityFeature:84,TopList:90,DETSeatOrder:85,MediaReview:336,SCMGoodsComment:9911};var ShareRelatedObjectTypes={MovieIsReleased:1001,MovieUpcoming:1002,MovieHasAwards:1003,MovieGeneral:1004,MovieContentPlot:1005,MovieRoleDescInfo:1006,MovieRoleDescAll:1007,MovieBehindCurtain:1008,MovieVerseLines:1009,MovieBehindTemplate:1010,MovieTelecinePage:1011,PersonFavorableComment:2001,News:5101,ImageNews:5102,MovieLongComment:9991,MovieShortComment:9992,MovieLeaveComment:9993,VideoMovie:4101,VideoPerson:4102,PictureMovie:11,PicturePerson:21,Cinema:33,IndexNewsTop:9981,Movie:1111,Blog:6001,ForumTopic:7001,Activity:2201,MediaReview:3361,Link:6401,OffsiteLink:64011,GoodsDetail:99991,NewsComment:51011,VideoMovieComment:41011,VideoPersonComment:41021,SCMGoodsDetail:99992};var ShareControlStyleType={FloatStyle:1,ListStyle:2,OnlyShare:3,OnlyShareSCM:4};var ShareTabType={shareToMtimeFriend:{name:"shareToMtimeFriend",text:"时光好友"},shareToEMail:{name:"shareToEMail",text:"邮件地址"},shareToWeb:{name:"shareToWeb",text:"其他网站"}};var GlobalUrlValue="";var ShareControlDialogBase=Class.create();Object.extend(ShareControlDialogBase.prototype,{name:"ShareControlDialogBase",title:"分享到我的时光",closed:false,dialog:null,tabContentRegion:null,options:{shareControl:null},setOptions:function(a){Object.extend(Object.extend(this,this.options),a)},initialize:function(a){this.setOptions(a);this.initializeField();this.initializeDOM();this.initializeControl();this.initializeEvent();this.load()},initializeField:function(){},initializeDOM:function(){this.tabContentRegion},destroyDOM:function(){this.shareControl=this.dialog=this.tabHeaderRegion=this.tabContentRegion=null},initializeControl:function(){this.dialog=new Dialog({title:this.title,content:this.tabContentRegion,windowClassName:"w600",closeCallback:this.close.bind(this)})},destroyControl:function(){},initializeEvent:function(){},destroyEvent:function(){},load:function(){},close:function(){if(!this.closed){this.closed=true;this.destroyControl();this.destroyEvent();this.destroyDOM()}}});var ShareToMtimeFriendDialog=Class.create();Object.extend(ShareToMtimeFriendDialog.prototype,ShareControlDialogBase.prototype);Object.extend(ShareToMtimeFriendDialog.prototype,{defaultPrompt:"还可以输入210个字",reasonDefaultTxt:"分享理由",reasonMaxLength:210,dialogTemplate:new Template('<div class="sharemid"><span class="load48" style="display:none;" _type="loading"></span><div class="editshare"><span _type="digit_feedback">#{defaultPrompt}</span> <textarea _type="txtreason" class="curr">#{defaultText}</textarea></div><div class="#{middleShareClassName} clearfix" _type="addition_region">#{middleShareHtml}</div></div>'),closed:false,selectFirstImage:false,content:null,txtReason:null,shareButton:null,onClickShareButtonHandler:null,getShareInfoAdditionalInfo:function(c,b,a){if(typeof(siteCommunityServiceUrl)!="undefined"){return Mtime.Component.Ajax.crossDomainCallBack(siteCommunityServiceUrl,"Mtime.Community.Services.CommunityService","GetShareInfoAdditionalInfo",[c,b],a,"/community.api?Ajax_CallBack=true","get","20000")}},getShortenUrl:function(b,a){return Mtime.Component.Ajax.get("Mtime.Service.Pages.TwitterService","ShortenUrl",[b],a,"/Service/Twitter.msi","get","20000")},loadEditorJs:function(a){if(typeof(Weibo)!="undefined"&&Weibo.Face&&Weibo.Image&&Weibo.Sync&&Weibo.Syntax&&Weibo.Topic&&Weibo.Video){a&&a()}else{if(self.debug){$loadJs(["/js/2011/weibo/editor/editor.js","/js/2011/weibo/editor/image.js","/js/2011/weibo/editor/face.js","/js/2011/weibo/editor/sync.js","/js/2011/weibo/editor/syntax.js","/js/2011/weibo/editor/video.js","/js/2011/weibo/editor/topic.js"],function(){a&&a()})}else{$loadJs("/js/2011/weiboEditor.js",function(){a&&a()})}}},load:function(){},initializeDOM:function(){ShareControlDialogBase.prototype.initializeDOM.apply(this);var a=this.shareControl.shareInfo;this.textAreaContent=this.reasonDefaultTxt;if(this.shareControl.shareMtimeContent){this.textAreaContent=this.shareControl.shareMtimeContent()}this.content=Builder.build(this.dialogTemplate.evaluate({defaultPrompt:this.defaultPrompt,defaultText:this.textAreaContent,middleShareClassName:this.shareControl.middleShareClassName,middleShareHtml:this.shareControl.getMiddleShareHtml()}));this.shareButton=$(Builder.node("a",{className:"sharelink"},["分 享"]));this.tabContentRegion=this.content},initializeControl:function(){ShareControlDialogBase.prototype.initializeControl.apply(this);if(this.dialog.buttonRegion){this.dialog.buttonRegion.appendChild(this.shareButton);this.dialog.buttonRegion.addClassName("btnshare")}this.txtReason=this.content.down('[_type="txtreason"]');this.editorTextbox=new Textbox({text:this.txtReason,watermarkText:"",focusClassName:"",blurClassName:""});this.editorTextbox.text.value=this.textAreaContent;var c=this;if(this.shareControl.relatedObjType===MtimeShareRelatedObjectTypes.CMSNews||this.shareControl.relatedObjType===MtimeShareRelatedObjectTypes.Cinema||this.shareControl.relatedObjType===MtimeShareRelatedObjectTypes.SCMGoodsComment){if(this.shareControl.getShareObjectPicUrl){this.shareImageUrl=this.shareControl.getShareObjectPicUrl()}}this.loadEditorJs(function(){c.editor=new Weibo.Editor({editor:c.txtReason});new Weibo.Feedback({editor:c.editor,digitFeedback:{target:c.content.down('[_type="digit_feedback"]'),normalTemplate:"还可以输入{2}个字",warnTemplate:'<font color="red">字数超出{3}字</font>'}})});var b=this.shareControl.shareInfo;var a=this.content.down('[_type="loading"]');if(b.needAdditionalInfo){a.show();this.getShareInfoAdditionalInfo(this.shareControl.relatedObjType,this.shareControl.getShareObjectId(),function(m){if(m&&m.value&&(m.value.picUrls||m.value.videoUrls||m.value.extPicUrls)){var j="",g="",q="";var i=['<ul class="infotab clearfix" _type="nav">'];var d=m.value;if((d.picUrls&&d.picUrls.length>0)||(m.value.extPicUrls&&m.value.extPicUrls.length>0)){if(d.extPicUrls&&d.extPicUrls.length>0){if(d.picUrls){d.picUrls=d.extPicUrls.concat(d.picUrls)}else{d.picUrls=m.value.extPicUrls}}i.push('<li _type="image" class="curr"><i class="i_share_pic">&nbsp;</i>选择一张图片<i class="i_share_select">&nbsp;</i></li>');var f=['<div class="infoslist" _type="images"><div class="infoscroll">'];if(d.picUrls.length>5){f.push('<a href="#" onclick="return false;" _type="turnleft" class="i_share_prev">&nbsp;</a><a href="#" class="i_share_next" _type="turnright" onclick="return false;">&nbsp;</a>')}f.push('<div _type="slidesregion" class="scrollmid">');d.picUrls.each(function(s,r){if(r%5==0){if(r/5!=0){f.push("</ul>");f.push('<ul style="display:none;">')}else{f.push("<ul>")}}f.push('<li _imageurl="'+s+'" name="tab"><img src="'+s+'" width="90" /></li>')});f.push("</ul></div></div></div>");g=f.join("")}if(d.videoUrls&&d.videoUrls.length>0){var p=[];if(i.length==1){i.push('<li _type="video" class="curr"><i class="i_share_play">&nbsp;</i>选择一个视频<i class="i_share_select">&nbsp;</i></li>');p=['<div class="infoslist" _type="videos"><div class="infoscroll">']}else{i.push('<li _type="video"><i class="i_share_play">&nbsp;</i>选择一个视频</li>');p=['<div class="infoslist" _type="videos" style="display:none"><div class="infoscroll">']}if(d.videoUrls.length>5){p.push('<a href="#" onclick="return false;" _type="turnleft" class="i_share_prev">&nbsp;</a><a href="#" class="i_share_next" _type="turnright" onclick="return false;">&nbsp;</a>')}p.push('<div _type="slidesregion" class="scrollmid">');d.videoCoverUrls.each(function(s,r){if(r%5==0){if(r/5!=0){p.push("</ul>");p.push('<ul style="display:none;">')}else{p.push("<ul>")}}p.push('<li _videourl="'+d.videoUrls[r].url+'" title="'+d.videoUrls[r].title+'" name="tab"><img src="'+s+'" width="90"></li>')});p.push("</ul></div></div></div>");q=p.join("")}i.push("</ul>");j=i.join("");var e=c.content.down('[_type="addition_region"]');j&&e.appendChild(Builder.build(j));g&&e.appendChild(Builder.build(g));q&&e.appendChild(Builder.build(q));c.navRegion=c.content.down('[_type="nav"]');if(c.navRegion.childElements().length<2){c.navRegion=null}c.imagesRegion=c.content.down('[_type="images"]');c.videosRegion=c.content.down('[_type="videos"]');if(c.selectFirstImage&&c.imagesRegion){var h=c.imagesRegion.down("li[_imageurl]");imgUrl=h.readAttribute("_imageurl");c.shareImageUrl=imgUrl;h.addClassName("curr");var n='<i class="i_sharecurr"></i>';h.appendChild(Builder.build(n))}if(c.navRegion){c.navControlHandler=c.navControl.bind(c);Event.observe(c.navRegion,"click",c.navControlHandler)}if(c.imagesRegion||c.videosRegion){c.selectImageOrVideoHandler=c.selectImageOrVideo.bind(c);c.imagesRegion&&Event.observe(c.imagesRegion,"click",c.selectImageOrVideoHandler);c.videosRegion&&Event.observe(c.videosRegion,"click",c.selectImageOrVideoHandler);c.videosRegion&&(c.videoCheckTimeout=setTimeout(c.videoCheck.bind(c),500));if(d.picUrls&&d.picUrls.length>5){var l=c.imagesRegion.down('[_type="turnleft"]');var k=c.imagesRegion.down('[_type="turnright"]');var o=c.imagesRegion.down('[_type="slidesregion"]');c.buildSlidesControl(o,k,l)}if(d.videoUrls&&d.videoUrls.length>5){var l=c.videosRegion.down('[_type="turnleft"]');var k=c.videosRegion.down('[_type="turnright"]');var o=c.videosRegion.down('[_type="slidesregion"]');c.buildSlidesControl(o,k,l)}}}a.hide()})}},buildSlidesControl:function(f,d,e){var a=f.childElements();if(a.length>1){var b=0;var c=a.length;Event.observe(d,"click",function(){$(a[b]).hide();if(b!=c-1){++b}else{b=0}$(a[b]).show()});Event.observe(e,"click",function(){$(a[b]).hide();if(b!=0){b=0}else{b=c-1}$(a[b]).show()})}},destroyDOM:function(){this.editor.destroy();ShareControlDialogBase.prototype.destroyDOM.apply(this);this.content=null;this.txtReason=null;this.shareButton=null;if(this.textAreaContent){this.textAreaContent=null}},initializeEvent:function(){ShareControlDialogBase.prototype.initializeEvent.apply(this);this.onClickShareButtonHandler=this.onClickShareButton.bindAsEventListener(this);Event.observe(this.shareButton,"click",this.onClickShareButtonHandler)},destroyEvent:function(){this.navRegion&&Event.stopObserving(this.navRegion,"click",this.navControlHandler);this.imagesRegion&&Event.stopObserving(this.imagesRegion,"click",this.selectImageOrVideoHandler);this.videosRegion&&Event.stopObserving(this.videosRegion,"click",this.selectImageOrVideoHandler);this.videoCheckTimeout&&clearTimeout(this.videoCheckTimeout);Event.stopObserving(this.shareButton,"click",this.onClickShareButtonHandler);ShareControlDialogBase.prototype.destroyEvent.apply(this)},navControl:function(e){var d=Event.findElement(e,"li");if(d!=document&&!d.hasClassName("curr")){var f=d.up();var g=d.getAttribute("_type");var a=f.down(".curr");var c=a.getAttribute("_type");var b=a.down(".i_share_select");b&&b.remove();a.removeClassName("curr");d.addClassName("curr");d.appendChild(Builder.build('<i class="i_share_select"></i>'));this.content.down('[_type="'+c+'s"]').hide();this.content.down('[_type="'+g+'s"]').show()}},videoCheck:function(){this.videoCheckTimeout&&clearTimeout(this.videoCheckTimeout);this.videoCheckTimeout=null;var b=this.editorTextbox.getValue();if(this.shareVideoUrl&&b.indexOf(this.shareVideoUrl)==-1){var a=this.videosRegion.down('li[shortenurl="'+this.shareVideoUrl+'"]');if(a){a.removeClassName("curr");this.shareVideoUrl=null}}this.videoCheckTimeout=setTimeout(this.videoCheck.bind(this),500)},selectImageOrVideo:function(c){var b=Event.findElement(c,"li");if(b!=document&&(b.hasAttribute("_imageurl")||b.hasAttribute("_videourl"))){if(b.hasClassName("curr")){if(b.hasAttribute("_imageurl")){this.shareImageUrl=null}else{var i=this.shareVideoUrl;if(i){var j=this.editorTextbox.getValue().replace(new RegExp(i,"ig"),"");this.editor.editor.value="";this.editor.insertText(j)}this.shareVideoUrl=null}var f=b.down(".i_sharecurr");f&&f.remove();b.removeClassName("curr")}else{if(b.hasAttribute("_imageurl")){this.shareImageUrl=b.getAttribute("_imageurl");var d=b.up('[_type="images"]').down(".curr");var e=d&&d.down(".i_sharecurr");d&&d.removeClassName("curr");e&&e.remove();b.addClassName("curr");b.appendChild(Builder.build('<i class="i_sharecurr"></i>'))}else{var i=this.shareVideoUrl;var j=this.editorTextbox.getValue().replace(new RegExp(i,"ig"),"");this.editor.editor.value="";this.editor.insertText(j);i=b.getAttribute("_videourl");var g=b.getAttribute("shortenurl");var h=this;var a=function(){h.editor.insertText(h.shareVideoUrl+" ");var k=b.up('[_type="videos"]').down(".curr");var l=k&&k.down(".i_sharecurr");k&&k.removeClassName("curr");l&&l.remove();b.addClassName("curr");b.appendChild(Builder.build('<i class="i_sharecurr"></i>'))};if(g){this.shareVideoUrl=g;a()}else{this.getShortenUrl(i,function(k){if(k&&k.value&&k.value.errorCode!=1){g=k.value.shortenUrl;b.setAttribute("shortenurl",g);h.shareVideoUrl=g;a()}})}}}}},saveShareCallback:function(a){if(a){var b=a.value;switch(b){case -2:$alert("您在时光网发布的内容违反互联网管理规定，对此帐户予禁言处理。",null,null,1);this.dialog.close();break;case -1:$alert("转发理由含有敏感词，请修改后再试",null,null,1);this.dialog.close();break;case 0:$alert("转发失败，请稍后再试",null,null,1);this.dialog.close();break;case 1:case 2:$alert("转发成功",null,null,1);if(this.shareControl.shareSuccessCallBack){this.shareControl.shareSuccessCallBack()}this.dialog.close();break;default:this.dialog.close();break}}},saveTweetShareCallback:function(b){var a=null;switch(b.value){case -5:a="原作者微评正在审核中，如有不便敬请谅解!";break;case -9:case -4:case -3:case -2:case 0:a="转发微评失败";break;case -1:a="转发微评失败,内容过长";break;case -11:a="转发微评失败,您被禁言";break;case -10:a="转发微评失败,内容包含敏感词";break;case -20:a="你发布的速度太快了，休息一下吧：）";break}if(a){$alert(a,null,null,1)}else{$alert("转发成功",null,null,1);if(this.shareControl.shareSuccessCallBack){this.shareControl.shareSuccessCallBack()}}this.dialog.close()},onClickShareButton:function(a){var d=this.txtReason.value.trim();var c=this.editor.getLength();if(c>this.editor.lengthExp.max){return}else{var b=this.shareImageUrl?this.shareImageUrl:"";var e="";this.shareControl.saveShare(d,this.saveShareCallback.bind(this),this.saveTweetShareCallback.bind(this),this.shareButton,b,e)}}});var ShareControlBase=Class.create();Object.extend(ShareControlBase.prototype,{name:"ShareControlBase",EXCERPT_SIZE:50,closed:false,MtimeShareRelatedObjectTypes:$H(MtimeShareRelatedObjectTypes),ShareRelatedObjectTypes:$H(ShareRelatedObjectTypes),avaliableTabs:[ShareTabType.shareToMtimeFriend,ShareTabType.shareToEMail,ShareTabType.shareToWeb],relatedObjType:0,shareRelatedObjType:0,isAjaxData:true,shareButton:null,shareInfo:null,shareContainer:null,shareControlStyleType:ShareControlStyleType.FloatStyle,middleShareClassName:"boxshare",server:{saveShareInfo:function(e,d,c,a,b,f){if(siteCommunityServiceUrl){return Mtime.Component.Ajax.crossDomainCallBack(siteCommunityServiceUrl,"Mtime.Community.Services.CommunityService","SaveShareInfoCrossDomainByFlash",[e,d,c,b,f],a,"/community.api?Ajax_CallBack=true","post","20000")}},ForwardTweet:function(c,b,a){return Mtime.Component.Ajax.crossDomainCallBack(siteServiceUrl,"Mtime.Service.Pages.TwitterService","ForwardTweetCrossDomainByFlash",c,b,"/Service/Twitter.msi","post","20000",a)},getIsLogin:function(a){if(typeof(siteCommunityServiceUrl)!="undefined"){return Mtime.Component.Ajax.crossDomainCallBack(siteCommunityServiceUrl,"Mtime.Community.Services.CommunityService","GetIsLogin",[],a,"/community.api?Ajax_CallBack=true","get","20000")}},getShareInfo:function(e,d,c,b,a,f){if(siteCommunityServiceUrl){if(b===""){return Mtime.Component.Ajax.crossDomainCallBack(siteCommunityServiceUrl,"Mtime.Community.Services.CommunityService","GetShareInfo",[e,d,c],a,"/community.api?Ajax_CallBack=true","get","20000",f)}else{return Mtime.Component.Ajax.crossDomainCallBack(siteCommunityServiceUrl,"Mtime.Community.Services.CommunityService","GetShareInfoExpand",[e,d,c,b],a,"/community.api?Ajax_CallBack=true","get","20000",f)}}}},ButtonInfoMap:$H({toSinaMicroblogging:{name:"toSinaMicroblogging",shareClassName:"sinaweibo",text:"新浪微博",type:ShareTabType.shareToWeb,urlFormat:"javascript:GlobalSiteShare('http://service.t.sina.com.cn/share/share.php?appkey=166678827&pic={2}&ralateUid=1663735900&url={0}&title={1}');"},toQQ:{name:"toQQ",shareClassName:"qq",text:"QQ",type:ShareTabType.shareToWeb,urlFormat:"javascript:GlobalSiteShare('http://connect.qq.com/widget/shareqq/index.html?url={0}&desc=&title={1}&summary=&pics={2}&flash=&site=http://www.mtime.com');"},toQzone:{name:"toQzone",shareClassName:"qzone",text:"QQ空间",type:ShareTabType.shareToWeb,urlFormat:"javascript:GlobalSiteShare('http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url={0}&desc={1}');"},toTencentMicroblogging:{name:"toTencentMicroblogging",shareClassName:"qqweibo",text:"腾讯微博",type:ShareTabType.shareToWeb,urlFormat:"javascript:GlobalSiteShare('http://v.t.qq.com/share/share.php?url={0}&appkey=351dd60cf63a48429932e971ca31e87c&site=http://www.mtime.com&pic={2}&title={1}');"},toEMail:{name:"toEMail",shareClassName:"email",text:"电子邮件",type:ShareTabType.shareToEMail,urlFormat:"mailto:?subject={3}&body={4}"},toMtime:{name:"toMtime",shareClassName:"mytime",text:"我的时光",type:ShareTabType.shareToMtimeFriend}}),options:{desc:"",expandMovieId:0,shareContainer:null,shareButton:null,autoLoad:true,callback:null,shareSuccessCallBack:null},setOptions:function(a){Object.extend(Object.extend(this,this.options),a)},typeMapping:function(){if(this.isAjaxData){if(this.shareRelatedObjType==0){if(this.relatedObjType==0){throw"shareRelatedObjType not set and relatedObjType not set!"}switch(this.relatedObjType){case MtimeShareRelatedObjectTypes.Movie:this.shareRelatedObjType=ShareRelatedObjectTypes.MovieGeneral;break;case MtimeShareRelatedObjectTypes.Person:this.shareRelatedObjType=ShareRelatedObjectTypes.PersonNotFavorableComment;break;case MtimeShareRelatedObjectTypes.CMSNews:this.shareRelatedObjType=ShareRelatedObjectTypes.NewsGeneral;break;case MtimeShareRelatedObjectTypes.MoviePicture:this.shareRelatedObjType=ShareRelatedObjectTypes.PictureMovie;break;case MtimeShareRelatedObjectTypes.PersonPicture:this.shareRelatedObjType=ShareRelatedObjectTypes.PicturePerson;break;case MtimeShareRelatedObjectTypes.Cinema:this.shareRelatedObjType=ShareRelatedObjectTypes.Cinema;break;default:throw"relatedObjType not Mapping shareRelatedObjType!";break}}}},initialize:function(a){this.setOptions(a);this.initializeField();this.typeMapping();this.initializeDOM();this.initializeEvent();this.load();this.render();this.initializeControl();Event.observe(window,"unload",this.close.bind(this))},initializeField:function(){this.avaliableTabs=$A(this.avaliableTabs);this.collectBoxId=null},initializeDOM:function(){var b=this.ButtonInfoMap.values();var c=[];var e=siteCommunityServiceUrl+"/ShareHandler.ashx?shareRelatedObjType="+this.shareRelatedObjType+"&relatedId="+this.getShareObjectId()+"&expandId="+this.getShareExpandId()+"&expandContext="+decodeURIComponent(this.getShareExpandContext())+"&screenshotImageUrl="+this.getScreenshotImageUrl();if(this.shareButton&&this.shareContainer){this.shareContainer.hide();if(this.shareControlStyleType==ShareControlStyleType.FloatStyle){c.push('<ul class="clearfix">');for(var d=0;d<b.length;++d){var a=b[d];if(this.avaliableTabs.indexOf(a.type)<0){continue}if(a.name==="toMtime"){c.push('<li class="'+a.shareClassName+'"><a method="'+a.name+'" href="javascript:void(0);">'+a.text+"</a></li>")}else{if(a.name==="toEMail"){c.push('<li class="'+a.shareClassName+'"><a method="'+a.name+'" href="javascript:EmailIframe(\''+e+"&method="+a.name+"');\" >"+a.text+"</a></li>")}else{c.push('<li class="'+a.shareClassName+'"><a method="'+a.name+'" href="javascript:GlobalSiteShare(\''+e+"&method="+a.name+"');\" >"+a.text+"</a></li>")}}}c.push("</ul>");this.shareContainer.innerHTML=c.join("")}else{if(this.shareControlStyleType==ShareControlStyleType.ListStyle){for(var d=0;d<b.length;++d){var a=b[d];if(this.avaliableTabs.indexOf(a.type)<0){continue}if(a.name==="toMtime"){c.push('<p class="'+a.shareClassName+'"><a method="'+a.name+'" href="javascript:void(0);">'+a.text+"</a></p>")}else{if(a.name==="toEMail"){c.push('<p class="'+a.shareClassName+'"><a method="'+a.name+'" href="javascript:EmailIframe(\''+e+"&method="+a.name+"');\" >"+a.text+"</a></p>")}else{c.push('<p class="'+a.shareClassName+'"><a method="'+a.name+'" href="javascript:GlobalSiteShare(\''+e+"&method="+a.name+"');\" >"+a.text+"</a></p>")}}}this.shareContainer.innerHTML=c.join("")}else{throw"shareControlStyleType does not implemented!"}}}else{if(this.shareButton&&!this.shareContainer){if(this.shareControlStyleType==ShareControlStyleType.OnlyShare||this.shareControlStyleType==ShareControlStyleType.OnlyShareSCM){this.shareContainer=Builder.node("div",{className:"inner newsharebar"},[Builder.node("div",{className:"smtimebar"},[Builder.node("div",{className:"sharebox"})])]);for(var d=0;d<b.length;++d){var a=b[d];if(this.avaliableTabs.indexOf(a.type)<0){continue}if(a.name==="toMtime"){c.push('<p class="'+a.shareClassName+'"><a method="'+a.name+'" href="javascript:void(0);">'+a.text+"</a></p>")}else{if(a.name==="toEMail"){c.push('<p class="'+a.shareClassName+'"><a method="'+a.name+'" href="javascript:EmailIframe(\''+e+"&method="+a.name+"');\" >"+a.text+"</a></p>")}else{c.push('<p class="'+a.shareClassName+'"><a method="'+a.name+'" href="javascript:GlobalSiteShare(\''+e+"&method="+a.name+"');\" >"+a.text+"</a></p>")}}}this.shareContainer.getElementsBySelector("div.sharebox")[0].innerHTML=c.join("")}}}},destroyDOM:function(){if(this.shareButton){this.shareButton=null}if(this.shareContainer){this.shareContainer=null}if(this.collectBoxId){this.collectBoxId=null}if(this.windowOpen){this.windowOpen=null}},initializeEvent:function(){if(!this.autoLoad){this.onClickShareButtonHandler=this.onClickShareButton.bindAsEventListener(this);if(this.shareButton){this.shareButton.observe("click",this.onClickShareButtonHandler)}}this.onClickshareContainerHandler=this.onClickshareContainer.bindAsEventListener(this);if(this.shareContainer){this.shareContainer.observe("click",this.onClickshareContainerHandler)}},destroyEvent:function(){if(this.shareButton){this.shareButton.stopObserving("click",this.onClickShareButtonHandler)}if(this.shareContainer){this.shareContainer.stopObserving("click",this.onClickshareContainerHandler)}},initializeControl:function(){if(this.shareControlStyleType==ShareControlStyleType.OnlyShare||this.shareControlStyleType==ShareControlStyleType.OnlyShareSCM){var b=this;var a=this.shareControlStyleType==ShareControlStyleType.OnlyShareSCM;this.collectBox=new DialogBox({element:this.shareButton,content:this.shareContainer.outerHTML,arrowNew:true,onClick:function(d){var e=Event.pointerX(d);var f=Event.pointerY(d);var c=Event.element(d);if(c!=this.element&&!c.descendantOf(this.element)&&!c.descendantOf(this.windowElement)&&!Position.within(this.windowElement,e,f)){this.close();b.close()}},setupDimensions:function(){if(a){this.windowElement.addClassName("my_shop")}var k=0,m=0;var o=this.windowElement.getDimensions();var p=o.width;var n=o.height;var i=this.elementX+this.elementWidth/2;var j=this.elementY;var f=i;var g=j+this.elementHeight;if(this.arrowNew){var d=this.cardId.down("em."+this.indicationStyle)}else{var d=this.cardId.down("p."+this.indicationStyle)}var c;if(d===undefined||d===null){c=17}else{c=d.getHeight()}switch(this.positionType){case 0:k=f-47;m=g+c;break;case 1:k=f-(p-47);m=g+c;break;case 2:k=i-47;m=j-c-n;break;case 3:k=i-(p-47);m=j-c-n;break;default:k=f-47;m=g+c;break}var q=0;if(this.overlay){q=parseInt(this.overlay.getStyle("zIndex"),10)+1}else{q=Windows.getZIndex()+1}if(Mtime.browser.ie&&Mtime.browser.ie>=7){var e=this.element.getHeight();var h=this.element.getStyle("fontSize");var l=parseInt(h.slice(0,2),10);if(this.element.innerHTML!==""&&e>l+10){k=200}}this.windowElement.setStyle({position:"absolute",top:m+"px",left:k+"px",zIndex:q})}});this.collectBoxId=$(this.collectBox.id);if(this.collectBoxId){this.collectBoxId.observe("click",this.onClickshareContainerHandler)}}},destroyControl:function(){if(this.shareControlStyleType==ShareControlStyleType.OnlyShare||this.shareControlStyleType==ShareControlStyleType.OnlyShareSCM){if(this.collectBox){this.collectBox.close();this.collectBox=null}}},load:function(){if(this.autoLoad&&this.isAjaxData){this.server.getShareInfo(this.shareRelatedObjType,this.getShareObjectId(),this.getShareExpandId(),this.getShareExpandContext(),this.getShareInfoCallback.bind(this),this.shareContainer)}},render:function(){},renderWebShareLinks:function(){var f=this.getShareObjectUrl();var e=this.getShareObjectTitle();var c="";var d=encodeURIComponent(this.getShareObjectDefaultRecommendContent("subject"));var a=encodeURIComponent(this.getShareObjectDefaultRecommendContent("body"));if(this.getShareObjectPicUrl()){c=this.getShareObjectPicUrl()}var b=this.shareContainer.getElementsBySelector("a").each(function(g){var i=g.readAttribute("method");var h=this.ButtonInfoMap[i];if(h&&h.type==ShareTabType.shareToWeb){g.href=String.format(h.urlFormat,f,e,c)}if(h&&h.type==ShareTabType.shareToEMail){g.href=String.format(h.urlFormat,f,e,c,d,a)}}.bind(this))},shareInfoLoaded:function(){},getShareInfoCallback:function(a){if(typeof getShareInfoResult!="undefined"&&getShareInfoResult.value){this.shareInfo=getShareInfoResult.value;this.shareInfoLoaded();this.renderWebShareLinks();if(this.autoLoad){this.onClickShareButtonHandler=this.onClickShareButton.bindAsEventListener(this);if(this.shareButton){this.shareButton.observe("click",this.onClickShareButtonHandler)}}this.showShareDialog(a)}else{$alert("加载对象信息出错，请刷新页面重试")}},onClickShareButton:function(b){var a=Event.findElement(b,"div");this.callback&&this.callback(a);if(a.hasClassName("curr")){a.removeClassName("curr");if(this.shareContainer){this.shareContainer.hide()}}else{if(a.hasClassName("notcurr")){a.removeClassName("notcurr")}a.addClassName("curr");if(this.shareContainer){this.shareContainer.show()}}Event.stop(b)},onClickshareContainer:function(h){var g=Event.findElement(h,"a");if(!g||!g.readAttribute){return}var p=g.readAttribute("method");if(!p){return}if(this.shareRelatedObjType===ShareRelatedObjectTypes.MovieBehindTemplate){var o=this.shareContainer.up().up().up().down("ul").getElementsBySelector("li");if(typeof o!="undefined"&&o!=null&&o.length>0){var f=o[0];var m=f.readAttribute("title");var l=f.readAttribute("imgabstract");var n=f.down("img").readAttribute("src");this.title=m;this.pic=n;this.desc=l;var u=this.getShareObjectUrl();var t=this.getShareObjectTitle();var q="";var s=encodeURIComponent(this.getShareObjectDefaultRecommendContent("subject"));var a=encodeURIComponent(this.getShareObjectDefaultRecommendContent("body"));if(this.getShareObjectPicUrl()){q=this.getShareObjectPicUrl()}var b=this.shareContainer.getElementsBySelector("a").each(function(i){var w=i.readAttribute("method");var v=this.ButtonInfoMap[w];if(v&&v.type==ShareTabType.shareToWeb){i.href=String.format(v.urlFormat,u,t,q)}if(v&&v.type==ShareTabType.shareToEMail){i.href=String.format(v.urlFormat,u,t,q,s,a)}}.bind(this))}}else{if(this.shareRelatedObjType===ShareRelatedObjectTypes.ImageNews){if(this.imageId!=this.expandMovieId){this.shareInfo=null;this.expandMovieId=this.imageId;var d=this.ButtonInfoMap.values();var j=[];var r=siteCommunityServiceUrl+"/ShareHandler.ashx?shareRelatedObjType="+this.shareRelatedObjType+"&relatedId="+this.getShareObjectId()+"&expandId="+this.getShareExpandId()+"&screenshotImageUrl="+this.getScreenshotImageUrl();var e=r+"&method="+p;if(this.shareButton&&this.shareContainer){if(this.shareControlStyleType==ShareControlStyleType.FloatStyle){j.push('<ul class="clearfix">');for(var k=0;k<d.length;++k){var c=d[k];if(this.avaliableTabs.indexOf(c.type)<0){continue}if(c.name==="toMtime"){j.push('<li class="'+c.shareClassName+'"><a method="'+c.name+'" href="javascript:void(0);">'+c.text+"</a></li>")}else{if(c.name==="toEMail"){j.push('<li class="'+c.shareClassName+'"><a method="'+c.name+'" href="javascript:EmailIframe(\''+r+"&method="+c.name+"');\" >"+c.text+"</a></li>")}else{j.push('<li class="'+c.shareClassName+'"><a method="'+c.name+'" href="javascript:GlobalSiteShare(\''+r+"&method="+c.name+"');\" >"+c.text+"</a></li>")}}}j.push("</ul>");this.shareContainer.innerHTML=j.join("")}else{if(this.shareControlStyleType==ShareControlStyleType.ListStyle){for(var k=0;k<d.length;++k){var c=d[k];if(this.avaliableTabs.indexOf(c.type)<0){continue}if(c.name==="toMtime"){j.push('<p class="'+c.shareClassName+'"><a method="'+c.name+'" href="javascript:void(0);">'+c.text+"</a></p>")}else{if(c.name==="toEMail"){j.push('<p class="'+c.shareClassName+'"><a method="'+c.name+'" href="javascript:EmailIframe(\''+r+"&method="+c.name+"');\" >"+c.text+"</a></p>")}else{j.push('<p class="'+c.shareClassName+'"><a method="'+c.name+'" href="javascript:GlobalSiteShare(\''+r+"&method="+c.name+"');\" >"+c.text+"</a></p>")}}}this.shareContainer.innerHTML=j.join("")}}}GlobalUrlValue=e}}}if(this.shareInfo===null&&this.isAjaxData){this.server.getShareInfo(this.shareRelatedObjType,this.getShareObjectId(),this.getShareExpandId(),this.getShareExpandContext(),this.getShareInfoCallback.bind(this,p),this.shareContainer)}else{this.showShareDialog(p,h)}},shareTrack:function(a){var c=null;if(this.shareRelatedObjType!=0){this.ShareRelatedObjectTypes.find(function(d){if(d.value===this.relatedObjType){c=d.key}return false}.bind(this))}else{this.MtimeShareRelatedObjectTypes.find(function(d){if(d.value===this.relatedObjType){c=d.key}return false}.bind(this))}if(!c){return}var b=String.format("M11_Common_Share{0}_{1}",c,a);if(typeof tracker!=="undefined"&&typeof tracker.trackAdView!=="undefined"){tracker.trackClick("M11_Common",b)}},showShareDialog:function(b,c){var a=this.ButtonInfoMap[b];if(!a){return}if(a.type==ShareTabType.shareToWeb||a.type==ShareTabType.shareToEMail){if(!c){}if(this.shareSuccessCallBack){this.shareSuccessCallBack()}this.shareTrack(b)}else{if(c){Event.stop(c)}if(!this.shareInfo||typeof(this.shareInfo.isLogin)=="undefined"||this.shareInfo.isLogin==null){this.server.getIsLogin(function(){if(typeof(getIsLogin)!="undefined"&&getIsLogin.value){if(!getIsLogin.value.isLogin){$redirect(this.getSignInUrl());return}switch(a.type){case ShareTabType.shareToMtimeFriend:this.showShareToMtimeFriendDialog();if(this.shareButton){if(this.shareButton.hasClassName("curr")){this.shareButton.removeClassName("curr");if(this.shareContainer){this.shareContainer.hide()}}}break;default:throw"ButtonType does not implemented"}}}.bind(this))}else{if(!this.shareInfo.isLogin){$redirect(this.getSignInUrl());return}switch(a.type){case ShareTabType.shareToMtimeFriend:this.showShareToMtimeFriendDialog();if(this.shareButton){if(this.shareButton.hasClassName("curr")){this.shareButton.removeClassName("curr");if(this.shareContainer){this.shareContainer.hide()}}}break;default:throw"ButtonType does not implemented"}}}},showShareToMtimeFriendDialog:function(){new ShareToMtimeFriendDialog({shareControl:this})},getSignInUrl:function(){return siteMcUrl+"/member/signin/operation/?redirectUrl="+encodeURIComponent(location.href)},getShareObjectUrl:function(){return""},getShareObjectPicUrl:function(){return""},getShareObjectMailTitle:function(){return""},getShareObjectTitle:function(){return""},getShareObjectId:function(){return 0},getShareExpandId:function(){return 0},getShareExpandContext:function(){return""},getScreenshotImageUrl:function(){return""},getShareObjectDefaultRecommendContent:function(c){var b="分享一篇文章-"+this.getShareObjectTitle();var a="你好，这篇文章写的不错，我想你可能会感兴趣，推荐你去看看！《"+this.getShareObjectTitle()+"》"+this.getShareObjectUrl();if(c==="subject"){return b}else{return a}},getShareObjectDefaultRecommendSuffix:function(){return""},getMiddleShareHtml:function(){return""},saveShareInternal:function(c,a,f,d,b,g){if(this.shareRelatedObjType==ShareRelatedObjectTypes.MovieShortComment||this.shareRelatedObjType==ShareRelatedObjectTypes.MovieLeaveComment){this.server.ForwardTweet([c,this.getShareObjectId(),false,false],f,d)}else{var e=this.getShareObjectId();if(this.shareRelatedObjType===ShareRelatedObjectTypes.MovieContentPlot||this.shareRelatedObjType===ShareRelatedObjectTypes.MovieRoleDescInfo||this.shareRelatedObjType===ShareRelatedObjectTypes.MovieBehindCurtain||this.shareRelatedObjType===ShareRelatedObjectTypes.MovieVerseLines||this.shareRelatedObjType===ShareRelatedObjectTypes.MovieBehindTemplate||this.shareRelatedObjType===ShareRelatedObjectTypes.MediaReview){e=this.expandMovieId}this.server.saveShareInfo(this.relatedObjType,e,c,a,b,g)}},onSaveShareCallback:function(a,b){if(b){a(b)}},onTweetSaveShareCallback:function(a,b){if(b){a(b)}},saveShare:function(c,a,e,d,b,f){this.saveShareInternal(c,this.onSaveShareCallback.bind(this,a),this.onTweetSaveShareCallback.bind(this,e),d,b,f)},close:function(){if(!this.closed){this.closed=true;this.destroyControl();this.destroyEvent();this.destroyDOM()}}});var ShareMovieControl=Class.create();Object.extend(ShareMovieControl.prototype,ShareControlBase.prototype);Object.extend(ShareMovieControl.prototype,{name:"ShareMovieControl",relatedObjType:MtimeShareRelatedObjectTypes.Movie,shareRelatedObjType:ShareRelatedObjectTypes.Movie,options:Object.extend(Object.extend({},ShareControlBase.prototype.options),{movieId:0}),getMiddleShareHtml:function(){var a=[];var b="";if(this.shareInfo.movieLength!==""){b=this.shareInfo.movieLength+"分钟 - "}a.push('<div class="picmid"><a title="'+this.shareInfo.movieName+'" target="_blank" href="'+this.shareInfo.coverLinkUrl+'"><img alt="'+this.shareInfo.movieName+'" src="'+this.shareInfo.coverImageUrl+'" /></a></div>');a.push('<div class="txtmid"><h2><a target="_blank" href="'+this.shareInfo.coverLinkUrl+'">'+this.shareInfo.movieName+" ("+this.shareInfo.movieYear+")</a></h2><h3>"+this.shareInfo.movieNameEn+"</h3><ul><li>"+b+this.shareInfo.movieTypes+"</li><li>导演："+this.shareInfo.movieDirectors+"</li><li>主演："+this.shareInfo.movieActors+"</li></ul></div>");return a.join("")},shareMtimeContent:function(){return"分享电影"},getShareObjectUrl:function(){return this.shareInfo.movieLink},getShareObjectTitle:function(){return this.shareInfo.title},getShareObjectId:function(){return this.movieId},getShareExpandId:function(){return 0},getShareObjectMailTitle:function(){return this.shareInfo.mailTitle},getShareObjectPicUrl:function(){return this.shareInfo.pic},getShareObjectDefaultRecommendContent:function(c){var b="分享一部电影《"+this.getShareObjectMailTitle()+"》";var a=this.getShareObjectTitle();if(c==="subject"){return b}else{return a}}});var ShareMovieIsReleasedControl=Class.create();Object.extend(ShareMovieIsReleasedControl.prototype,ShareControlBase.prototype);Object.extend(ShareMovieIsReleasedControl.prototype,{name:"ShareMovieIsReleasedControl",relatedObjType:MtimeShareRelatedObjectTypes.Movie,shareRelatedObjType:ShareRelatedObjectTypes.MovieIsReleased,options:Object.extend(Object.extend({},ShareControlBase.prototype.options),{movieId:0}),getMiddleShareHtml:function(){var a=[];var b="";if(this.shareInfo.movieLength!==""){b=this.shareInfo.movieLength+"分钟 - "}a.push('<div class="picmid"><a title="'+this.shareInfo.movieName+'" target="_blank" href="'+this.shareInfo.coverLinkUrl+'"><img alt="'+this.shareInfo.movieName+'" src="'+this.shareInfo.coverImageUrl+'" /></a></div>');a.push('<div class="txtmid"><h2><a target="_blank" href="'+this.shareInfo.coverLinkUrl+'">'+this.shareInfo.movieName+" ("+this.shareInfo.movieYear+")</a></h2><h3>"+this.shareInfo.movieNameEn+"</h3><ul><li>"+b+this.shareInfo.movieTypes+"</li><li>导演："+this.shareInfo.movieDirectors+"</li><li>主演："+this.shareInfo.movieActors+"</li></ul></div>");return a.join("")},shareMtimeContent:function(){return"分享电影"},getShareObjectUrl:function(){return this.shareInfo.movieLink},getShareObjectTitle:function(){return this.shareInfo.title},getShareObjectId:function(){return this.movieId},getShareExpandId:function(){return 0},getShareObjectMailTitle:function(){return this.shareInfo.mailTitle},getShareObjectPicUrl:function(){return this.shareInfo.pic},getShareObjectDefaultRecommendContent:function(c){var b="分享一部电影《"+this.getShareObjectMailTitle()+"》";var a=this.getShareObjectTitle();if(c==="subject"){return b}else{return a}}});var ShareMovieUpcomingControl=Class.create();Object.extend(ShareMovieUpcomingControl.prototype,ShareControlBase.prototype);Object.extend(ShareMovieUpcomingControl.prototype,{name:"ShareMovieUpcomingControl",relatedObjType:MtimeShareRelatedObjectTypes.Movie,shareRelatedObjType:ShareRelatedObjectTypes.MovieUpcoming,options:Object.extend(Object.extend({},ShareControlBase.prototype.options),{movieId:0}),getMiddleShareHtml:function(){var a=[];var b="";if(this.shareInfo.movieLength!==""){b=this.shareInfo.movieLength+"分钟 - "}a.push('<div class="picmid"><a title="'+this.shareInfo.movieName+'" target="_blank" href="'+this.shareInfo.coverLinkUrl+'"><img alt="'+this.shareInfo.movieName+'" src="'+this.shareInfo.coverImageUrl+'" /></a></div>');a.push('<div class="txtmid"><h2><a target="_blank" href="'+this.shareInfo.coverLinkUrl+'">'+this.shareInfo.movieName+" ("+this.shareInfo.movieYear+")</a></h2><h3>"+this.shareInfo.movieNameEn+"</h3><ul><li>"+b+this.shareInfo.movieTypes+"</li><li>导演："+this.shareInfo.movieDirectors+"</li><li>主演："+this.shareInfo.movieActors+"</li></ul></div>");return a.join("")},shareMtimeContent:function(){return"分享电影"},getShareObjectUrl:function(){return this.shareInfo.movieLink},getShareObjectTitle:function(){return this.shareInfo.title},getShareObjectId:function(){return this.movieId},getShareExpandId:function(){return 0},getShareObjectMailTitle:function(){return this.shareInfo.mailTitle},getShareObjectPicUrl:function(){return this.shareInfo.pic},getShareObjectDefaultRecommendContent:function(c){var b="分享一部电影《"+this.getShareObjectMailTitle()+"》";var a=this.getShareObjectTitle();if(c==="subject"){return b}else{return a}}});var ShareMovieHasAwardsControl=Class.create();Object.extend(ShareMovieHasAwardsControl.prototype,ShareControlBase.prototype);Object.extend(ShareMovieHasAwardsControl.prototype,{name:"ShareMovieHasAwardsControl",relatedObjType:MtimeShareRelatedObjectTypes.Movie,shareRelatedObjType:ShareRelatedObjectTypes.MovieHasAwards,options:Object.extend(Object.extend({},ShareControlBase.prototype.options),{movieId:0}),getMiddleShareHtml:function(){var a=[];var b="";if(this.shareInfo.movieLength!==""){b=this.shareInfo.movieLength+"分钟 - "}a.push('<div class="picmid"><a title="'+this.shareInfo.movieName+'" target="_blank" href="'+this.shareInfo.coverLinkUrl+'"><img alt="'+this.shareInfo.movieName+'" src="'+this.shareInfo.coverImageUrl+'" /></a></div>');a.push('<div class="txtmid"><h2><a target="_blank" href="'+this.shareInfo.coverLinkUrl+'">'+this.shareInfo.movieName+" ("+this.shareInfo.movieYear+")</a></h2><h3>"+this.shareInfo.movieNameEn+"</h3><ul><li>"+b+this.shareInfo.movieTypes+"</li><li>导演："+this.shareInfo.movieDirectors+"</li><li>主演："+this.shareInfo.movieActors+"</li></ul></div>");return a.join("")},shareMtimeContent:function(){return"分享电影"},getShareObjectUrl:function(){return this.shareInfo.movieLink},getShareObjectTitle:function(){return this.shareInfo.title},getShareObjectId:function(){return this.movieId},getShareExpandId:function(){return 0},getShareObjectMailTitle:function(){return this.shareInfo.mailTitle},getShareObjectPicUrl:function(){return this.shareInfo.pic},getShareObjectDefaultRecommendContent:function(c){var b="分享一部电影《"+this.getShareObjectMailTitle()+"》";var a=this.getShareObjectTitle();if(c==="subject"){return b}else{return a}}});var ShareMovieGeneralControl=Class.create();Object.extend(ShareMovieGeneralControl.prototype,ShareControlBase.prototype);Object.extend(ShareMovieGeneralControl.prototype,{name:"ShareMovieGeneralControl",relatedObjType:MtimeShareRelatedObjectTypes.Movie,shareRelatedObjType:ShareRelatedObjectTypes.MovieGeneral,options:Object.extend(Object.extend({},ShareControlBase.prototype.options),{movieId:0}),getMiddleShareHtml:function(){var a=[];var b="";if(this.shareInfo.movieLength!==""){b=this.shareInfo.movieLength+"分钟 - "}a.push('<div class="picmid"><a title="'+this.shareInfo.movieName+'" target="_blank" href="'+this.shareInfo.coverLinkUrl+'"><img alt="'+this.shareInfo.movieName+'" src="'+this.shareInfo.coverImageUrl+'" /></a></div>');a.push('<div class="txtmid"><h2><a target="_blank" href="'+this.shareInfo.coverLinkUrl+'">'+this.shareInfo.movieName+" ("+this.shareInfo.movieYear+")</a></h2><h3>"+this.shareInfo.movieNameEn+"</h3><ul><li>"+b+this.shareInfo.movieTypes+"</li><li>导演："+this.shareInfo.movieDirectors+"</li><li>主演："+this.shareInfo.movieActors+"</li></ul></div>");return a.join("")},shareMtimeContent:function(){return"分享电影"},getShareObjectUrl:function(){return this.shareInfo.movieLink},getShareObjectTitle:function(){return this.shareInfo.title},getShareObjectId:function(){return this.movieId},getShareExpandId:function(){return 0},getShareObjectMailTitle:function(){return this.shareInfo.mailTitle},getShareObjectPicUrl:function(){return this.shareInfo.pic},getShareObjectDefaultRecommendContent:function(c){var b="分享一部电影《"+this.getShareObjectMailTitle()+"》";var a=this.getShareObjectTitle();if(c==="subject"){return b}else{return a}}});var ShareMovieContentPlotControl=Class.create();Object.extend(ShareMovieContentPlotControl.prototype,ShareControlBase.prototype);Object.extend(ShareMovieContentPlotControl.prototype,{name:"ShareMovieContentPlotControl",relatedObjType:MtimeShareRelatedObjectTypes.Movie,shareRelatedObjType:ShareRelatedObjectTypes.MovieContentPlot,options:Object.extend(Object.extend({},ShareControlBase.prototype.options),{movieParagraphId:0}),getMiddleShareHtml:function(){var a=[];var b="";if(this.shareInfo.movieLength!==""){b=this.shareInfo.movieLength+"分钟 - "}a.push('<div class="picmid"><a title="'+this.shareInfo.movieName+'" target="_blank" href="'+this.shareInfo.coverLinkUrl+'"><img alt="'+this.shareInfo.movieName+'" src="'+this.shareInfo.coverImageUrl+'" /></a></div>');a.push('<div class="txtmid"><h2><a target="_blank" href="'+this.shareInfo.coverLinkUrl+'">'+this.shareInfo.movieName+" ("+this.shareInfo.movieYear+")</a></h2><h3>"+this.shareInfo.movieNameEn+"</h3><ul><li>"+b+this.shareInfo.movieTypes+"</li><li>导演："+this.shareInfo.movieDirectors+"</li><li>主演："+this.shareInfo.movieActors+"</li></ul></div>");return a.join("")},shareMtimeContent:function(){return this.shareInfo.shareReason},getShareObjectUrl:function(){return this.shareInfo.movieParagraphLink},getShareObjectTitle:function(){return this.shareInfo.title},getShareObjectId:function(){return this.movieParagraphId},getShareExpandId:function(){return 0},getShareObjectMailTitle:function(){return this.shareInfo.mailTitle},getShareObjectDefaultRecommendContent:function(c){var b="分享《"+this.getShareObjectMailTitle()+"》剧情";var a=this.getShareObjectTitle();if(c==="subject"){return b}else{return a}}});var ShareMovieRoleDescInfoControl=Class.create();Object.extend(ShareMovieRoleDescInfoControl.prototype,ShareControlBase.prototype);Object.extend(ShareMovieRoleDescInfoControl.prototype,{name:"ShareMovieRoleDescInfoControl",relatedObjType:MtimeShareRelatedObjectTypes.Movie,shareRelatedObjType:ShareRelatedObjectTypes.MovieRoleDescInfo,options:Object.extend(Object.extend({},ShareControlBase.prototype.options),{movieRoleId:0}),getMiddleShareHtml:function(){var a=[];var b="";if(this.shareInfo.movieLength!==""){b=this.shareInfo.movieLength+"分钟 - "}a.push('<div class="picmid"><a title="'+this.shareInfo.movieName+'" target="_blank" href="'+this.shareInfo.coverLinkUrl+'"><img alt="'+this.shareInfo.movieName+'" src="'+this.shareInfo.coverImageUrl+'" /></a></div>');a.push('<div class="txtmid"><h2><a target="_blank" href="'+this.shareInfo.coverLinkUrl+'">'+this.shareInfo.movieName+" ("+this.shareInfo.movieYear+")</a></h2><h3>"+this.shareInfo.movieNameEn+"</h3><ul><li>"+b+this.shareInfo.movieTypes+"</li><li>导演："+this.shareInfo.movieDirectors+"</li><li>主演："+this.shareInfo.movieActors+"</li></ul></div>");return a.join("")},shareMtimeContent:function(){return this.shareInfo.shareReason},getShareObjectUrl:function(){return this.shareInfo.movieRoleLink},getShareObjectTitle:function(){return this.shareInfo.title},getShareObjectId:function(){return this.movieRoleId},getShareExpandId:function(){return 0},getShareObjectMailTitle:function(){return this.shareInfo.mailTitle},getShareObjectPicUrl:function(){return this.shareInfo.pic},getShareObjectDefaultRecommendContent:function(c){var b="分享《"+this.getShareObjectMailTitle()+"》角色介绍";var a=this.getShareObjectTitle();if(c==="subject"){return b}else{return a}}});var ShareMovieRoleDescAllControl=Class.create();Object.extend(ShareMovieRoleDescAllControl.prototype,ShareControlBase.prototype);Object.extend(ShareMovieRoleDescAllControl.prototype,{name:"ShareMovieRoleDescAllControl",relatedObjType:MtimeShareRelatedObjectTypes.Movie,shareRelatedObjType:ShareRelatedObjectTypes.MovieRoleDescAll,options:Object.extend(Object.extend({},ShareControlBase.prototype.options),{movieId:0}),getMiddleShareHtml:function(){var a=[];var b="";if(this.shareInfo.movieLength!==""){b=this.shareInfo.movieLength+"分钟 - "}a.push('<div class="picmid"><a title="'+this.shareInfo.movieName+'" target="_blank" href="'+this.shareInfo.coverLinkUrl+'"><img alt="'+this.shareInfo.movieName+'" src="'+this.shareInfo.coverImageUrl+'" /></a></div>');a.push('<div class="txtmid"><h2><a target="_blank" href="'+this.shareInfo.coverLinkUrl+'">'+this.shareInfo.movieName+" ("+this.shareInfo.movieYear+")</a></h2><h3>"+this.shareInfo.movieNameEn+"</h3><ul><li>"+b+this.shareInfo.movieTypes+"</li><li>导演："+this.shareInfo.movieDirectors+"</li><li>主演："+this.shareInfo.movieActors+"</li></ul></div>");return a.join("")},shareMtimeContent:function(){return this.shareInfo.shareReason},getShareObjectUrl:function(){return this.shareInfo.movieRoleLink},getShareObjectTitle:function(){return this.shareInfo.title},getShareObjectId:function(){return this.movieId},getShareExpandId:function(){return 0},getShareObjectMailTitle:function(){return this.shareInfo.mailTitle},getShareObjectDefaultRecommendContent:function(c){var b="分享《"+this.getShareObjectMailTitle()+"》角色介绍";var a=this.getShareObjectTitle();if(c==="subject"){return b}else{return a}}});var ShareMovieBehindCurtainControl=Class.create();Object.extend(ShareMovieBehindCurtainControl.prototype,ShareControlBase.prototype);Object.extend(ShareMovieBehindCurtainControl.prototype,{name:"ShareMovieBehindCurtainControl",relatedObjType:MtimeShareRelatedObjectTypes.Movie,shareRelatedObjType:ShareRelatedObjectTypes.MovieBehindCurtain,options:Object.extend(Object.extend({},ShareControlBase.prototype.options),{behindSectionID:0}),getMiddleShareHtml:function(){var a=[];var b="";if(this.shareInfo.movieLength!==""){b=this.shareInfo.movieLength+"分钟 - "}a.push('<div class="picmid"><a title="'+this.shareInfo.movieName+'" target="_blank" href="'+this.shareInfo.coverLinkUrl+'"><img alt="'+this.shareInfo.movieName+'" src="'+this.shareInfo.coverImageUrl+'" /></a></div>');a.push('<div class="txtmid"><h2><a target="_blank" href="'+this.shareInfo.coverLinkUrl+'">'+this.shareInfo.movieName+" ("+this.shareInfo.movieYear+")</a></h2><h3>"+this.shareInfo.movieNameEn+"</h3><ul><li>"+b+this.shareInfo.movieTypes+"</li><li>导演："+this.shareInfo.movieDirectors+"</li><li>主演："+this.shareInfo.movieActors+"</li></ul></div>");return a.join("")},shareMtimeContent:function(){return this.shareInfo.shareReason},getShareObjectUrl:function(){return this.shareInfo.behindSectionLink},getShareObjectTitle:function(){return this.shareInfo.title},getShareObjectId:function(){return this.behindSectionID},getShareExpandId:function(){return 0},getShareObjectMailTitle:function(){return this.shareInfo.mailTitle},getShareObjectPicUrl:function(){return this.getScreenshotImageUrl()},getScreenshotImageUrl:function(){if(this.shareInfo){return this.shareInfo.screenshotImageUrl}else{return""}},getShareObjectDefaultRecommendContent:function(c){var b="分享《"+this.getShareObjectMailTitle()+"》幕后看点";var a=this.getShareObjectTitle();if(c==="subject"){return b}else{return a}}});var ShareMovieVerseLinesControl=Class.create();Object.extend(ShareMovieVerseLinesControl.prototype,ShareControlBase.prototype);Object.extend(ShareMovieVerseLinesControl.prototype,{name:"ShareMovieVerseLinesControl",relatedObjType:MtimeShareRelatedObjectTypes.Movie,shareRelatedObjType:ShareRelatedObjectTypes.MovieVerseLines,options:Object.extend(Object.extend({},ShareControlBase.prototype.options),{behindSectionID:0}),getMiddleShareHtml:function(){var a=[];var b="";if(this.shareInfo.movieLength!==""){b=this.shareInfo.movieLength+"分钟 - "}a.push('<div class="picmid"><a title="'+this.shareInfo.movieName+'" target="_blank" href="'+this.shareInfo.coverLinkUrl+'"><img alt="'+this.shareInfo.movieName+'" src="'+this.shareInfo.coverImageUrl+'" /></a></div>');a.push('<div class="txtmid"><h2><a target="_blank" href="'+this.shareInfo.coverLinkUrl+'">'+this.shareInfo.movieName+" ("+this.shareInfo.movieYear+")</a></h2><h3>"+this.shareInfo.movieNameEn+"</h3><ul><li>"+b+this.shareInfo.movieTypes+"</li><li>导演："+this.shareInfo.movieDirectors+"</li><li>主演："+this.shareInfo.movieActors+"</li></ul></div>");return a.join("")},shareMtimeContent:function(){return this.shareInfo.shareReason},getShareObjectUrl:function(){return this.shareInfo.behindSectionLink},getShareObjectTitle:function(){return this.shareInfo.title},getShareObjectId:function(){return this.behindSectionID},getShareExpandId:function(){return 0},getShareObjectMailTitle:function(){return this.shareInfo.mailTitle},getShareObjectPicUrl:function(){return this.getScreenshotImageUrl()},getScreenshotImageUrl:function(){if(this.shareInfo){return this.shareInfo.screenshotImageUrl}else{return""}},getShareObjectDefaultRecommendContent:function(c){var b="分享《"+this.getShareObjectMailTitle()+"》台词金句";var a=this.getShareObjectTitle();if(c==="subject"){return b}else{return a}}});var ShareMovieBehindTemplateControl=Class.create();Object.extend(ShareMovieBehindTemplateControl.prototype,ShareControlBase.prototype);Object.extend(ShareMovieBehindTemplateControl.prototype,{name:"ShareMovieBehindTemplateControl",relatedObjType:MtimeShareRelatedObjectTypes.Movie,shareRelatedObjType:ShareRelatedObjectTypes.MovieBehindTemplate,isAjaxData:false,options:Object.extend(Object.extend({},ShareControlBase.prototype.options),{title:"",link:"",pic:"",desc:"",movieId:"",shareInfo:{isLogin:null,needAdditionalInfo:false}}),render:function(){this.server.getShareInfo(this.shareRelatedObjType,this.getShareObjectId(),this.getShareExpandId(),this.getShareExpandContext(),function(){if(typeof getShareInfoResult!="undefined"&&getShareInfoResult.value){this.shareInfo=getShareInfoResult.value}else{$alert("加载对象信息出错，请刷新页面重试")}var f=this.getShareObjectUrl();var e=this.getShareObjectTitle();var c="";var d=encodeURIComponent(this.getShareObjectDefaultRecommendContent("subject"));var a=encodeURIComponent(this.getShareObjectDefaultRecommendContent("body"));if(this.getShareObjectPicUrl()){c=this.getShareObjectPicUrl()}var b=this.shareContainer.getElementsBySelector("a").each(function(g){var i=g.readAttribute("method");var h=this.ButtonInfoMap[i];if(h&&h.type==ShareTabType.shareToWeb){g.href=String.format(h.urlFormat,f,e,c)}if(h&&h.type==ShareTabType.shareToEMail){g.href=String.format(h.urlFormat,f,e,c,d,a)}}.bind(this))}.bind(this),this.shareContainer)},getMiddleShareHtml:function(){var a=[];var b="";if(this.shareInfo.movieLength!==""){b=this.shareInfo.movieLength+"分钟 - "}a.push('<div class="picmid"><a title="'+this.shareInfo.movieName+'" target="_blank" href="'+this.shareInfo.coverLinkUrl+'"><img alt="'+this.shareInfo.movieName+'" src="'+this.shareInfo.coverImageUrl+'" /></a></div>');a.push('<div class="txtmid"><h2><a target="_blank" href="'+this.shareInfo.coverLinkUrl+'">'+this.shareInfo.movieName+" ("+this.shareInfo.movieYear+")</a></h2><h3>"+this.shareInfo.movieNameEn+"</h3><ul><li>"+b+this.shareInfo.movieTypes+"</li><li>导演："+this.shareInfo.movieDirectors+"</li><li>主演："+this.shareInfo.movieActors+"</li></ul></div>");return a.join("")},shareMtimeContent:function(){return this.title+" "+this.desc+this.link},getShareObjectUrl:function(){return this.link},getShareObjectTitle:function(){return"《"+this.shareInfo.movieName+"》-"+this.title+" "+this.desc+this.link},getShareObjectId:function(){return this.movieId},getShareExpandId:function(){return this.movieId},getShareObjectMailTitle:function(){return this.shareInfo.movieName},getShareObjectPicUrl:function(){return this.pic},getShareObjectDefaultRecommendContent:function(c){var b="分享《"+this.getShareObjectMailTitle()+"》幕后";var a=this.getShareObjectTitle();if(c==="subject"){return b}else{return a}}});var ShareMovieTelecinePageControl=Class.create();Object.extend(ShareMovieTelecinePageControl.prototype,ShareControlBase.prototype);Object.extend(ShareMovieTelecinePageControl.prototype,{name:"ShareMovieTelecinePageControl",relatedObjType:MtimeShareRelatedObjectTypes.Link,isAjaxData:false,options:Object.extend(Object.extend({},ShareControlBase.prototype.options),{date:new Date(),movieTitle:"",cityName:"",imageUrl:"",link:"",shareInfo:{isLogin:null,needAdditionalInfo:false}}),load:function(){this.getImagePath(null);ShareControlBase.prototype.load.apply(this)},getImagePath:function(a){if(!this.imageUrl){Mtime.Component.Ajax.get("Mtime.Service.Pages.TwitterService","UploadPicByUrl",[this.link],function(b){if(b&&b.value&&b.value.ImagePath){Mtime.Component.Ajax.get("Mtime.Service.Pages.TwitterService","GetThumbnailImageUrlByImagePath",[b.value.ImagePath],function(c){if(c&&c.value&&c.value.ImageUrl){this.imageUrl=b.value.ImagePath;this.link=c.value.ImageUrl;a&&a()}}.bind(this),"/Service/Twitter.msi","get","20000")}}.bind(this),"/Service/Twitter.msi","get","20000")}else{a&&a()}},getMiddleShareHtml:function(){var b=[];var a=this.date+" "+this.cityName+" 最新影讯";b.push('<div class="picmid"><a title="'+this.movieTitle+'" target="_blank" href="'+this.link+'"><img alt="'+this.movieTitle+'" src="'+this.imageUrl+'" /></a></div>');b.push('<div class="txtmid"><h2><a target="_blank" href="'+this.link+'">'+this.movieTitle+"</a></h2><p>"+a+"</p></div>");return b.join("")},shareMtimeContent:function(){return"《"+this.movieTitle+"》 "+this.date+" "+this.cityName+" 最新影讯 "+this.link},getShareObjectUrl:function(){return this.link},getShareObjectTitle:function(){return"《"+this.movieTitle+"》 "+this.date+" "+this.cityName+" 最新影讯地址："+this.link},getShareObjectPicUrl:function(){return this.imageUrl},getShareObjectMailTitle:function(){return"《"+this.movieTitle+"》 "+this.date+" "+this.cityName+" 影讯"},getShareObjectDefaultRecommendContent:function(c){var b=this.getShareObjectMailTitle();var a=this.getShareObjectTitle();if(c==="subject"){return b}else{return a}},serverLinkControl:{recommendLinkToShare:function(d,e,c,b,a){if(typeof(siteCommunityServiceUrl)!="undefined"){return Mtime.Component.Ajax.crossDomainCallBack(siteCommunityServiceUrl,"Mtime.Community.Services.CommunityService","RecommendLinkToShare",[d,e,c,b],a,"/community.api?Ajax_CallBack=true","get","20000")}}},onSaveShareCallback:function(a){if(typeof recommendLinkToShareResult!=="undefined"){a(recommendLinkToShareResult)}},saveShareInternal:function(b,a,c){this.serverLinkControl.recommendLinkToShare(this.title,this.link,b,this.desc,a)},render:function(){var f=this.getShareObjectUrl();var e=this.getShareObjectTitle();var c="";var d=encodeURIComponent(this.getShareObjectDefaultRecommendContent("subject"));var a=encodeURIComponent(this.getShareObjectDefaultRecommendContent("body"));if(this.getShareObjectPicUrl()){c=this.getShareObjectPicUrl();c=c.replace(new RegExp("&","ig"),"^PIC^")}var b=this.shareContainer.getElementsBySelector("a").each(function(g){var i=g.readAttribute("method");var h=this.ButtonInfoMap[i];if(h&&h.type==ShareTabType.shareToWeb){g.href=String.format(h.urlFormat,f,e,c)}if(h&&h.type==ShareTabType.shareToEMail){g.href=String.format(h.urlFormat,f,e,c,d,a)}}.bind(this))}});var SharePersonFavorableCommentControl=Class.create();Object.extend(SharePersonFavorableCommentControl.prototype,ShareControlBase.prototype);Object.extend(SharePersonFavorableCommentControl.prototype,{name:"SharePersonFavorableCommentControl",relatedObjType:MtimeShareRelatedObjectTypes.Person,shareRelatedObjType:ShareRelatedObjectTypes.PersonFavorableComment,options:Object.extend(Object.extend({},ShareControlBase.prototype.options),{personId:0}),getMiddleShareHtml:function(){var a=[];a.push('<div class="picmid"><a title="'+this.shareInfo.personName+'" target="_blank" href="'+this.shareInfo.coverLinkUrl+'"><img alt="'+this.shareInfo.personName+'" src="'+this.shareInfo.coverImageUrl+'" /></a></div>');a.push('<div class="txtmid"><h2><a target="_blank" href="'+this.shareInfo.coverLinkUrl+'">'+this.shareInfo.personName+"</a></h2><h3>"+this.shareInfo.personNameEn+"</h3><ul><li>"+this.shareInfo.personSex+"，"+this.shareInfo.personConstellation+"</li><li>职业："+this.shareInfo.personProfessions+"</li></ul></div>");return a.join("")},shareMtimeContent:function(){return"分享影人"},getShareObjectUrl:function(){return this.shareInfo.personLink},getShareObjectTitle:function(){return this.shareInfo.title},getShareObjectId:function(){return this.personId},getShareExpandId:function(){return 0},getShareObjectMailTitle:function(){return this.shareInfo.mailTitle},getShareObjectPicUrl:function(){return this.shareInfo.pic},getShareObjectDefaultRecommendContent:function(c){var b='关于"'+this.getShareObjectMailTitle()+'"';var a=this.getShareObjectTitle();if(c==="subject"){return b}else{return a}}});var ShareNewsControl=Class.create();Object.extend(ShareNewsControl.prototype,ShareControlBase.prototype);Object.extend(ShareNewsControl.prototype,{name:"ShareNewsControl",relatedObjType:MtimeShareRelatedObjectTypes.CMSNews,shareRelatedObjType:ShareRelatedObjectTypes.News,isPicNews:false,options:Object.extend(Object.extend({},ShareControlBase.prototype.options),{newsId:0}),renderWebShareLinks:function(){ShareControlBase.prototype.renderWebShareLinks.apply(this);this.middleShareClassName="infoshare"},getMiddleShareHtml:function(){var b=[];var a=this.shareInfo.description;if(a.bytelength()>this.EXCERPT_SIZE*2){a=a.substr(0,this.EXCERPT_SIZE)+"..."}b.push('<h2><a target="_blank" href="'+this.getShareObjectUrl()+'">'+a+"</a></h2>");return b.join("")},shareMtimeContent:function(){return"分享新闻"},getShareObjectUrl:function(){return this.shareInfo.newsLink},getShareObjectTitle:function(){return this.shareInfo.title},getShareObjectId:function(){return this.newsId},getShareExpandId:function(){return 0},getShareObjectMailTitle:function(){return this.shareInfo.mailTitle},getShareObjectDefaultRecommendContent:function(c){var b="电影新闻分享："+this.getShareObjectMailTitle();var a=this.getShareObjectTitle();if(c==="subject"){return b}else{return a}}});var ShareImageNewsControl=Class.create();Object.extend(ShareImageNewsControl.prototype,ShareControlBase.prototype);Object.extend(ShareImageNewsControl.prototype,{name:"ShareImageNewsControl",relatedObjType:MtimeShareRelatedObjectTypes.CMSGalleryImage,shareRelatedObjType:ShareRelatedObjectTypes.ImageNews,isPicNews:false,options:Object.extend(Object.extend({},ShareControlBase.prototype.options),{imageId:0}),renderWebShareLinks:function(){ShareControlBase.prototype.renderWebShareLinks.apply(this);this.isPicNews=true},initializeField:function(){ShareControlBase.prototype.initializeField.apply(this);this.expandMovieId=this.imageId},getMiddleShareHtml:function(){var a=[];var b=this.shareInfo.imageNewTitle;var c=this.shareInfo.imageTitle;a.push('<div class="picmid"><a title="'+b+'" target="_blank" href="'+this.getShareObjectUrl()+'"><img alt="'+b+'" src="'+this.getShareObjectPicUrl()+'" /></a></div>');a.push('<div class="txtmid"><h2><a target="_blank" href="'+this.getShareObjectUrl()+'">'+b+"</a></h2><p>"+c+"</p></div>");return a.join("")},shareMtimeContent:function(){return"分享新闻"},getShareObjectUrl:function(){return this.shareInfo.newsLink},getShareObjectTitle:function(){return this.shareInfo.title},getShareObjectId:function(){return this.imageId},getShareExpandId:function(){return 0},getShareObjectMailTitle:function(){return this.shareInfo.mailTitle},getShareObjectPicUrl:function(){return this.shareInfo.pic},getShareObjectDefaultRecommendContent:function(c){var b="电影新闻分享："+this.getShareObjectMailTitle();var a=this.getShareObjectTitle();if(c==="subject"){return b}else{return a}}});var ShareMovieLongCommentControl=Class.create();Object.extend(ShareMovieLongCommentControl.prototype,ShareControlBase.prototype);Object.extend(ShareMovieLongCommentControl.prototype,{name:"ShareMovieLongCommentControl",relatedObjType:MtimeShareRelatedObjectTypes.Blog,shareRelatedObjType:ShareRelatedObjectTypes.MovieLongComment,options:Object.extend(Object.extend({},ShareControlBase.prototype.options),{blogId:0,urlTypeId:0}),renderWebShareLinks:function(){ShareControlBase.prototype.renderWebShareLinks.apply(this);this.middleShareClassName="infoshare"},getMiddleShareHtml:function(){var b=[];var a=this.shareInfo.description;if(a.bytelength()>this.EXCERPT_SIZE*2){a=a.substr(0,this.EXCERPT_SIZE)+"..."}b.push('<h2><a target="_blank" href="'+this.getShareObjectUrl()+'">'+a+"</a></h2>");return b.join("")},shareMtimeContent:function(){return"分享影评"},getShareObjectUrl:function(){return this.shareInfo.blogLink},getShareObjectTitle:function(){this.shareInfo.title=this.shareInfo.title.replace(/\"/g,"＂");return this.shareInfo.title},getShareObjectId:function(){return this.blogId},getShareExpandId:function(){return this.urlTypeId},getShareObjectMailTitle:function(){return this.shareInfo.mailTitle},getShareObjectDefaultRecommendContent:function(c){var b="[影评分享]"+this.getShareObjectMailTitle();var a=this.getShareObjectTitle();if(c==="subject"){return b}else{return a}}});var ShareMovieShortCommentControl=Class.create();Object.extend(ShareMovieShortCommentControl.prototype,ShareControlBase.prototype);Object.extend(ShareMovieShortCommentControl.prototype,{name:"ShareMovieShortCommentControl",relatedObjType:MtimeShareRelatedObjectTypes.Twitter,shareRelatedObjType:ShareRelatedObjectTypes.MovieShortComment,middleShareClassName:"",options:Object.extend(Object.extend({},ShareControlBase.prototype.options),{tweetId:0}),shareMtimeContent:function(){return"分享微评"},getShareObjectUrl:function(){return this.shareInfo.tweetLink},getShareObjectTitle:function(){return this.shareInfo.title},getShareObjectId:function(){return this.tweetId},getShareExpandId:function(){return 0},getShareObjectMailTitle:function(){return this.shareInfo.mailTitle},getShareObjectDefaultRecommendContent:function(c){var b="关于《"+this.getShareObjectMailTitle()+"》的短评";var a=this.getShareObjectTitle();if(c==="subject"){return b}else{return a}}});var ShareMovieLeaveCommentControl=Class.create();Object.extend(ShareMovieLeaveCommentControl.prototype,ShareControlBase.prototype);Object.extend(ShareMovieLeaveCommentControl.prototype,{name:"ShareMovieLeaveCommentControl",relatedObjType:MtimeShareRelatedObjectTypes.Twitter,shareRelatedObjType:ShareRelatedObjectTypes.MovieLeaveComment,middleShareClassName:"",options:Object.extend(Object.extend({},ShareControlBase.prototype.options),{tweetId:0}),shareMtimeContent:function(){return"分享微评"},getShareObjectUrl:function(){return this.shareInfo.tweetLink},getShareObjectTitle:function(){return this.shareInfo.title},getShareObjectId:function(){return this.tweetId},getShareExpandId:function(){return 0},getShareObjectMailTitle:function(){return this.shareInfo.mailTitle},getShareObjectDefaultRecommendContent:function(c){var b='关于"'+this.getShareObjectMailTitle()+'"';var a=this.getShareObjectTitle();if(c==="subject"){return b}else{return a}}});var ShareVideoMovieControl=Class.create();Object.extend(ShareVideoMovieControl.prototype,ShareControlBase.prototype);Object.extend(ShareVideoMovieControl.prototype,{name:"ShareVideoMovieControl",relatedObjType:MtimeShareRelatedObjectTypes.Video,shareRelatedObjType:ShareRelatedObjectTypes.VideoMovie,options:Object.extend(Object.extend({},ShareControlBase.prototype.options),{videoId:0}),getMiddleShareHtml:function(){var a=[];a.push('<div class="picmid"><a title="'+this.shareInfo.videoTitleName+'" target="_blank" href="'+this.getShareObjectUrl()+'"><img alt="'+this.shareInfo.videoTitleName+'" src="'+this.shareInfo.specificVideoUrl+'" /><i class="i_share_video">&nbsp;</i><i class="i_share_mask">&nbsp;</i></a></div>');a.push('<div class="txtmid"><h2><a target="_blank" href="'+this.getShareObjectUrl()+'">'+this.shareInfo.videoTitleName+"</a></h2><p>"+this.shareInfo.videoName+"</p></div>");return a.join("")},shareMtimeContent:function(){return"分享视频"},getShareObjectUrl:function(){return this.shareInfo.videoLink},getShareObjectTitle:function(){return this.shareInfo.title},getShareObjectId:function(){return this.videoId},getShareExpandId:function(){return 0},getShareObjectMailTitle:function(){return this.shareInfo.mailTitle},getShareObjectDefaultRecommendContent:function(c){var b="分享视频："+this.getShareObjectMailTitle();var a=this.getShareObjectTitle();if(c==="subject"){return b}else{return a}}});var ShareVideoPersonControl=Class.create();Object.extend(ShareVideoPersonControl.prototype,ShareControlBase.prototype);Object.extend(ShareVideoPersonControl.prototype,{name:"ShareVideoPersonControl",relatedObjType:MtimeShareRelatedObjectTypes.Video,shareRelatedObjType:ShareRelatedObjectTypes.VideoPerson,options:Object.extend(Object.extend({},ShareControlBase.prototype.options),{videoId:0,personId:0}),getMiddleShareHtml:function(){var a=[];a.push('<div class="picmid"><a title="'+this.shareInfo.videoTitleName+'" target="_blank" href="'+this.getShareObjectUrl()+'"><img alt="'+this.shareInfo.videoTitleName+'" src="'+this.shareInfo.specificVideoUrl+'" /><i class="i_share_video">&nbsp;</i><i class="i_share_mask">&nbsp;</i></a></div>');a.push('<div class="txtmid"><h2><a target="_blank" href="'+this.getShareObjectUrl()+'">'+this.shareInfo.videoTitleName+"</a></h2><p>"+this.shareInfo.videoName+"</p></div>");return a.join("")},shareMtimeContent:function(){return"分享视频"},getShareObjectUrl:function(){return this.shareInfo.videoLink},getShareObjectTitle:function(){return this.shareInfo.title},getShareObjectId:function(){return this.videoId},getShareExpandId:function(){return this.personId},getShareObjectMailTitle:function(){return this.shareInfo.mailTitle},getShareObjectDefaultRecommendContent:function(c){var b="分享视频："+this.getShareObjectMailTitle();var a=this.getShareObjectTitle();if(c==="subject"){return b}else{return a}}});var SharePictureMovieControl=Class.create();Object.extend(SharePictureMovieControl.prototype,ShareControlBase.prototype);Object.extend(SharePictureMovieControl.prototype,{name:"SharePictureMovieControl",relatedObjType:MtimeShareRelatedObjectTypes.MoviePicture,shareRelatedObjType:ShareRelatedObjectTypes.PictureMovie,options:Object.extend(Object.extend({},ShareControlBase.prototype.options),{imageId:0}),getMiddleShareHtml:function(){var a=[];a.push('<div class="picmid"><a title="'+this.shareInfo.movieName+'" target="_blank" href="'+this.getShareObjectUrl()+'"><img alt="'+this.shareInfo.movieName+'" src="'+this.shareInfo.specificImageUrl+'" /></a></div>');a.push('<div class="txtmid"><h2><a target="_blank" href="'+this.getShareObjectUrl()+'">'+this.shareInfo.movieName+"</a></h2><p>"+this.shareInfo.specificImageTypeName+"</p></div>");return a.join("")},shareMtimeContent:function(){return"分享图片"},getShareObjectUrl:function(){return this.shareInfo.imageLink},getShareObjectTitle:function(){return this.shareInfo.title},getShareObjectId:function(){return this.imageId},getShareExpandId:function(){return 0},getShareObjectMailTitle:function(){return this.shareInfo.mailTitle},getShareObjectPicUrl:function(){return this.shareInfo.pic},getShareObjectDefaultRecommendContent:function(c){var b="分享图片："+this.getShareObjectMailTitle();var a=this.getShareObjectTitle();if(c==="subject"){return b}else{return a}}});var SharePicturePersonControl=Class.create();Object.extend(SharePicturePersonControl.prototype,ShareControlBase.prototype);Object.extend(SharePicturePersonControl.prototype,{name:"SharePicturePersonControl",relatedObjType:MtimeShareRelatedObjectTypes.PersonPicture,shareRelatedObjType:ShareRelatedObjectTypes.PicturePerson,options:Object.extend(Object.extend({},ShareControlBase.prototype.options),{imageId:0}),getMiddleShareHtml:function(){var a=[];a.push('<div class="picmid"><a title="'+this.shareInfo.personName+'" target="_blank" href="'+this.getShareObjectUrl()+'"><img alt="'+this.shareInfo.personName+'" src="'+this.shareInfo.specificImageUrl+'" /></a></div>');a.push('<div class="txtmid"><h2><a target="_blank" href="'+this.getShareObjectUrl()+'">'+this.shareInfo.personName+"</a></h2><p>"+this.shareInfo.specificImageTypeName+"</p></div>");return a.join("")},shareMtimeContent:function(){return"分享图片"},getShareObjectUrl:function(){return this.shareInfo.imageLink},getShareObjectTitle:function(){return this.shareInfo.title},getShareObjectId:function(){return this.imageId},getShareExpandId:function(){return this.personId},getShareObjectMailTitle:function(){return this.shareInfo.mailTitle},getShareObjectPicUrl:function(){return this.shareInfo.pic},getShareObjectDefaultRecommendContent:function(c){var b="分享图片："+this.getShareObjectMailTitle();var a=this.getShareObjectTitle();if(c==="subject"){return b}else{return a}}});var ShareCinemaControl=Class.create();Object.extend(ShareCinemaControl.prototype,ShareControlBase.prototype);Object.extend(ShareCinemaControl.prototype,{name:"ShareCinemaControl",relatedObjType:MtimeShareRelatedObjectTypes.Cinema,shareRelatedObjType:ShareRelatedObjectTypes.Cinema,options:Object.extend(Object.extend({},ShareControlBase.prototype.options),{cinemaId:0,date:new Date()}),getMiddleShareHtml:function(){var a=[];a.push('<div class="picmid"><a title="'+this.shareInfo.cinemaName+'" target="_blank" href="'+this.shareInfo.coverLinkUrl+'"><img alt="'+this.shareInfo.cinemaName+'" src="'+this.shareInfo.coverImageUrl+'" /></a></div>');a.push('<div class="txtmid"><h2><a target="_blank" href="'+this.shareInfo.coverLinkUrl+'">'+this.shareInfo.cinemaName+"</a></h2><p>"+this.shareInfo.description+"</p></div>");return a.join("")},shareMtimeContent:function(){return this.shareInfo.shareReason},getShareExpandContext:function(){return encodeURIComponent(this.getDatetime())},getShareObjectUrl:function(){return this.shareInfo.cinemaLink},getShareObjectTitle:function(){return this.shareInfo.title},getShareObjectId:function(){return this.cinemaId},getShareExpandId:function(){return 0},getShareObjectMailTitle:function(){return this.shareInfo.mailTitle},getShareObjectPicUrl:function(){return this.shareInfo.pic},getDatetime:function(){var f=this.date.getFullYear();var d=this.date.getMonth()+1;var b=this.date.getDate();var e=d.toString();if(d<10){e="0"+e}var c=b.toString();if(b<10){c="0"+c}var a=f+"年"+e+"月"+b+"日";return a},renderWebShareLinks:function(){var f=this.getShareObjectUrl();var e=this.getShareObjectTitle();var c="";var d=encodeURIComponent(this.getShareObjectDefaultRecommendContent("subject"));var a=encodeURIComponent(this.getShareObjectDefaultRecommendContent("body"));if(this.getShareObjectPicUrl()){c=this.getShareObjectPicUrl().replace(/\&/g,"^PIC^")}var b=this.shareContainer.getElementsBySelector("a").each(function(g){var i=g.readAttribute("method");var h=this.ButtonInfoMap[i];if(h&&h.type==ShareTabType.shareToWeb){g.href=String.format(h.urlFormat,f,e,c)}if(h&&h.type==ShareTabType.shareToEMail){g.href=String.format(h.urlFormat,f,e,c,d,a)}}.bind(this))},getShareObjectDefaultRecommendContent:function(d){var b=this.getDatetime();var c='"'+this.getShareObjectMailTitle()+'"'+b+"影讯";var a=this.getShareObjectTitle();if(d==="subject"){return c}else{return a}}});var ShareUniversalControl=Class.create();Object.extend(ShareUniversalControl.prototype,ShareControlBase.prototype);Object.extend(ShareUniversalControl.prototype,{name:"ShareUniversalControl",relatedObjType:51,isAjaxData:false,options:Object.extend(Object.extend({},ShareControlBase.prototype.options),{title:"",fullTitle:"",link:"",pic:"",desc:"",newsId:0,shareInfo:{isLogin:null,needAdditionalInfo:false}}),getMiddleShareHtml:function(){var a=[];a.push('<div class="picmid"><a title="'+this.title+'" target="_blank" href="'+this.getShareObjectUrl()+'"><img alt="'+this.title+'" src="'+this.getShareObjectPicUrl()+'" style="width:96px;height:96px" /></a></div>');a.push('<div class="txtmid"><h2><a target="_blank" href="'+this.getShareObjectUrl()+'">'+this.title+"</a></h2></div>");return a.join("")},shareMtimeContent:function(){return this.title+this.link},getShareObjectUrl:function(){return this.link},getShareObjectTitle:function(){return this.fullTitle+this.link},getShareObjectMailTitle:function(){return this.title},getShareObjectId:function(){return this.newsId},getShareObjectPicUrl:function(){return this.pic},getShareObjectDefaultRecommendContent:function(c){var b=this.getShareObjectMailTitle();var a=this.getShareObjectTitle();if(c==="subject"){return b}else{return a}},render:function(){var f=this.getShareObjectUrl();var e=this.getShareObjectTitle();var c="";var d=encodeURIComponent(this.getShareObjectDefaultRecommendContent("subject"));var a=encodeURIComponent(this.getShareObjectDefaultRecommendContent("body"));if(this.getShareObjectPicUrl()){c=this.getShareObjectPicUrl()}var b=this.shareContainer.getElementsBySelector("a").each(function(g){var i=g.readAttribute("method");var h=this.ButtonInfoMap[i];if(h&&h.type==ShareTabType.shareToWeb){g.href=String.format(h.urlFormat,f,e,c)}if(h&&h.type==ShareTabType.shareToEMail){g.href=String.format(h.urlFormat,f,e,c,d,a)}}.bind(this))}});var ShareBlogControl=Class.create();Object.extend(ShareBlogControl.prototype,ShareControlBase.prototype);Object.extend(ShareBlogControl.prototype,{name:"ShareBlogControl",relatedObjType:MtimeShareRelatedObjectTypes.Blog,shareRelatedObjType:ShareRelatedObjectTypes.Blog,options:Object.extend(Object.extend({},ShareControlBase.prototype.options),{blogId:0}),renderWebShareLinks:function(){ShareControlBase.prototype.renderWebShareLinks.apply(this);this.middleShareClassName="infoshare"},getMiddleShareHtml:function(){var b=[];var a=this.shareInfo.description;if(a.bytelength()>this.EXCERPT_SIZE*2){a=a.substr(0,this.EXCERPT_SIZE)+"..."}b.push('<h2><a target="_blank" href="'+this.getShareObjectUrl()+'">'+a+"</a></h2>");return b.join("")},shareMtimeContent:function(){return"分享文章"},getShareObjectUrl:function(){return this.shareInfo.blogLink},getShareObjectTitle:function(){return this.shareInfo.title},getShareObjectId:function(){return this.blogId},getShareExpandId:function(){return 0},getShareObjectMailTitle:function(){return this.shareInfo.mailTitle},getShareObjectDefaultRecommendContent:function(c){var b="[分享文章]"+this.getShareObjectMailTitle();var a=this.getShareObjectTitle();if(c==="subject"){return b}else{return a}}});var ShareForumTopicControl=Class.create();Object.extend(ShareForumTopicControl.prototype,ShareControlBase.prototype);Object.extend(ShareForumTopicControl.prototype,{name:"ShareForumTopicControl",relatedObjType:MtimeShareRelatedObjectTypes.ForumTopic,shareRelatedObjType:ShareRelatedObjectTypes.ForumTopic,options:Object.extend(Object.extend({},ShareControlBase.prototype.options),{topicId:0}),renderWebShareLinks:function(){ShareControlBase.prototype.renderWebShareLinks.apply(this);this.middleShareClassName="infoshare"},getMiddleShareHtml:function(){var b=[];var a=this.shareInfo.description;if(a.bytelength()>this.EXCERPT_SIZE*2){a=a.substr(0,this.EXCERPT_SIZE)+"..."}b.push('<h2><a target="_blank" href="'+this.getShareObjectUrl()+'">'+a+"</a></h2>");return b.join("")},shareMtimeContent:function(){return"分享文章"},getShareObjectUrl:function(){return this.shareInfo.topicLink},getShareObjectTitle:function(){return this.shareInfo.title},getShareObjectId:function(){return this.topicId},getShareExpandId:function(){return 0},getShareObjectMailTitle:function(){return this.shareInfo.mailTitle},getShareObjectDefaultRecommendContent:function(c){var b="[分享文章]"+this.getShareObjectMailTitle();var a=this.getShareObjectTitle();if(c==="subject"){return b}else{return a}}});var ShareActivityControl=Class.create();Object.extend(ShareActivityControl.prototype,ShareControlBase.prototype);Object.extend(ShareActivityControl.prototype,{name:"ShareActivityControl",relatedObjType:MtimeShareRelatedObjectTypes.Activity,shareRelatedObjType:ShareRelatedObjectTypes.Activity,options:Object.extend(Object.extend({},ShareControlBase.prototype.options),{activityId:0}),renderWebShareLinks:function(){ShareControlBase.prototype.renderWebShareLinks.apply(this);this.middleShareClassName="infoshare"},getMiddleShareHtml:function(){var b=[];var a=this.shareInfo.description;if(a.bytelength()>this.EXCERPT_SIZE*2){a=a.substr(0,this.EXCERPT_SIZE)+"..."}b.push('<h2><a target="_blank" href="'+this.getShareObjectUrl()+'">'+a+"</a></h2>");return b.join("")},shareMtimeContent:function(){return"分享活动"},getShareObjectUrl:function(){return this.shareInfo.activityLink},getShareObjectTitle:function(){return this.shareInfo.title},getShareObjectId:function(){return this.activityId},getShareExpandId:function(){return 0},getShareObjectMailTitle:function(){return this.shareInfo.mailTitle},getShareObjectDefaultRecommendContent:function(c){var b="[分享活动]"+this.getShareObjectMailTitle();var a=this.getShareObjectTitle();if(c==="subject"){return b}else{return a}}});var ShareMediaReviewControl=Class.create();Object.extend(ShareMediaReviewControl.prototype,ShareControlBase.prototype);Object.extend(ShareMediaReviewControl.prototype,{name:"ShareMediaReviewControl",relatedObjType:MtimeShareRelatedObjectTypes.MediaReview,shareRelatedObjType:ShareRelatedObjectTypes.MediaReview,options:Object.extend(Object.extend({},ShareControlBase.prototype.options),{mediaReviewId:0}),getMiddleShareHtml:function(){var a=[];var b="";if(this.shareInfo.movieLength!==""){b=this.shareInfo.movieLength+"分钟 - "}a.push('<div class="picmid"><a title="'+this.shareInfo.movieName+'" target="_blank" href="'+this.shareInfo.coverLinkUrl+'"><img alt="'+this.shareInfo.movieName+'" src="'+this.shareInfo.coverImageUrl+'" /></a></div>');a.push('<div class="txtmid"><h2><a target="_blank" href="'+this.shareInfo.coverLinkUrl+'">'+this.shareInfo.movieName+" ("+this.shareInfo.movieYear+")</a></h2><h3>"+this.shareInfo.movieNameEn+"</h3><ul><li>"+b+this.shareInfo.movieTypes+"</li><li>导演："+this.shareInfo.movieDirectors+"</li><li>主演："+this.shareInfo.movieActors+"</li></ul></div>");return a.join("")},shareMtimeContent:function(){return this.shareInfo.shareReason},getShareObjectUrl:function(){return this.shareInfo.mediaReviewLink},getShareObjectTitle:function(){this.shareInfo.title=this.shareInfo.title.replace(/\"/g,"＂");return this.shareInfo.title},getShareObjectId:function(){return this.mediaReviewId},getShareExpandId:function(){return 0},getShareObjectMailTitle:function(){return this.shareInfo.mailTitle},getShareObjectPicUrl:function(){return this.shareInfo.pic},getShareObjectDefaultRecommendContent:function(c){var b="分享《"+this.getShareObjectMailTitle()+"》媒体影评";var a=this.getShareObjectTitle();if(c==="subject"){return b}else{return a}}});var ShareLinkControl=Class.create();Object.extend(ShareLinkControl.prototype,ShareControlBase.prototype);Object.extend(ShareLinkControl.prototype,{name:"ShareLinkControl",relatedObjType:MtimeShareRelatedObjectTypes.Link,isAjaxData:false,middleShareClassName:"",options:Object.extend(Object.extend({},ShareControlBase.prototype.options),{title:"",link:"",pic:"",desc:"",mtimeDefaultContent:"",shareInfo:{isLogin:null,needAdditionalInfo:false}}),shareMtimeContent:function(){return this.mtimeDefaultContent},getShareObjectUrl:function(){return this.link},getShareObjectTitle:function(){return this.title+this.link},getShareObjectMailTitle:function(){return this.title},getShareObjectId:function(){return 0},getShareObjectPicUrl:function(){return this.pic},getShareObjectDefaultRecommendContent:function(c){var b=this.getShareObjectMailTitle();var a=this.getShareObjectTitle();if(c==="subject"){return b}else{return a}},serverLinkControl:{recommendLinkToShare:function(d,e,c,b,a){if(typeof(siteCommunityServiceUrl)!="undefined"){return Mtime.Component.Ajax.crossDomainCallBack(siteCommunityServiceUrl,"Mtime.Community.Services.CommunityService","RecommendLinkToShare",[d,e,c,b],a,"/community.api?Ajax_CallBack=true","get","20000")}}},onSaveShareCallback:function(a){if(typeof recommendLinkToShareResult!=="undefined"){a(recommendLinkToShareResult)}},saveShareInternal:function(b,a,c){this.serverLinkControl.recommendLinkToShare(this.title,this.link,b,this.desc,a)},render:function(){var f=this.getShareObjectUrl();var e=this.getShareObjectTitle();var c="";var d=encodeURIComponent(this.getShareObjectDefaultRecommendContent("subject"));var a=encodeURIComponent(this.getShareObjectDefaultRecommendContent("body"));if(this.getShareObjectPicUrl()){c=this.getShareObjectPicUrl()}var b=this.shareContainer.getElementsBySelector("a").each(function(g){var i=g.readAttribute("method");var h=this.ButtonInfoMap[i];if(h&&h.type==ShareTabType.shareToWeb){g.href=String.format(h.urlFormat,f,e,c)}if(h&&h.type==ShareTabType.shareToEMail){g.href=String.format(h.urlFormat,f,e,c,d,a)}}.bind(this))}});var ShareOffsiteLinkControl=Class.create();Object.extend(ShareOffsiteLinkControl.prototype,ShareControlBase.prototype);Object.extend(ShareOffsiteLinkControl.prototype,{name:"ShareOffsiteLinkControl",relatedObjType:MtimeShareRelatedObjectTypes.OffsiteLink,isAjaxData:false,options:Object.extend(Object.extend({},ShareControlBase.prototype.options),{title:"",link:"",pic:"",desc:"",mtimeDefaultContent:""}),shareMtimeContent:function(){return this.mtimeDefaultContent},getShareObjectUrl:function(){return this.link},getShareObjectTitle:function(){return this.title+this.link},getShareObjectMailTitle:function(){return this.title},getShareObjectId:function(){return 0},getShareObjectPicUrl:function(){return this.pic},getShareObjectDefaultRecommendContent:function(c){var b=this.getShareObjectMailTitle();var a=this.getShareObjectTitle();if(c==="subject"){return b}else{return a}},initializeDOM:function(){var b=this.ButtonInfoMap.values();var c=[];if(this.shareContainer){for(var d=0;d<b.length;++d){var a=b[d];if(this.avaliableTabs.indexOf(a.type)<0){continue}if(a.name==="toMtime"||a.name==="toQzone"){}else{if(a.name==="toEMail"){c.push('<a class="'+a.shareClassName+'" method="'+a.name+'" href="###" >'+a.text+"</a>")}else{c.push('<a class="'+a.shareClassName+'" method="'+a.name+'" href="###" target="_self" >'+a.text+"</a>")}}}this.shareContainer.innerHTML=c.join("")}},render:function(){var f=this.getShareObjectUrl();var e=this.getShareObjectTitle();var c="";var d=encodeURIComponent(this.getShareObjectDefaultRecommendContent("subject"));var a=encodeURIComponent(this.getShareObjectDefaultRecommendContent("body"));if(this.getShareObjectPicUrl()){c=this.getShareObjectPicUrl()}var b=this.shareContainer.getElementsBySelector("a").each(function(g){var i=g.readAttribute("method");var h=this.ButtonInfoMap[i];if(h&&h.type==ShareTabType.shareToWeb){g.href=String.format(h.urlFormat,f,e,c)}if(h&&h.type==ShareTabType.shareToEMail){g.href=String.format(h.urlFormat,f,e,c,d,a)}}.bind(this))}});var ShareGoodsDetailControl=Class.create();Object.extend(ShareGoodsDetailControl.prototype,ShareControlBase.prototype);Object.extend(ShareGoodsDetailControl.prototype,{name:"ShareGoodsDetailControl",relatedObjType:MtimeShareRelatedObjectTypes.Link,isAjaxData:false,options:Object.extend(Object.extend({},ShareControlBase.prototype.options),{title:"",link:"",pic:"",shareInfo:{isLogin:null,needAdditionalInfo:false}}),getMiddleShareHtml:function(){var a=[];a.push('<div class="picmid"><a title="'+this.title+'" target="_blank" href="'+this.getShareObjectUrl()+'"><img alt="'+this.title+'" src="'+this.pic+'" /></a></div>');return a.join("")},shareMtimeContent:function(){return"分享商品"},getShareObjectUrl:function(){return this.link},getShareObjectTitle:function(){return this.title+this.link},getShareObjectMailTitle:function(){return this.title},getShareObjectId:function(){return 0},getShareObjectPicUrl:function(){return this.pic},getShareObjectDefaultRecommendContent:function(c){var b=this.getShareObjectMailTitle();var a=this.getShareObjectTitle();if(c==="subject"){return b}else{return a}},serverLinkControl:{recommendLinkToShare:function(d,e,c,b,a){if(typeof(siteCommunityServiceUrl)!="undefined"){return Mtime.Component.Ajax.crossDomainCallBack(siteCommunityServiceUrl,"Mtime.Community.Services.CommunityService","RecommendLinkToShare",[d,e,c,b],a,"/community.api?Ajax_CallBack=true","get","20000")}}},onSaveShareCallback:function(a){if(typeof recommendLinkToShareResult!=="undefined"){a(recommendLinkToShareResult)}},saveShareInternal:function(b,a,c){this.serverLinkControl.recommendLinkToShare(this.title,this.link,b,this.desc,a)},render:function(){var f=this.getShareObjectUrl();var e=this.getShareObjectTitle();var c="";var d=encodeURIComponent(this.getShareObjectDefaultRecommendContent("subject"));var a=encodeURIComponent(this.getShareObjectDefaultRecommendContent("body"));if(this.getShareObjectPicUrl()){c=this.getShareObjectPicUrl()}var b=this.shareContainer.getElementsBySelector("a").each(function(g){var i=g.readAttribute("method");var h=this.ButtonInfoMap[i];if(h&&h.type==ShareTabType.shareToWeb){g.href=String.format(h.urlFormat,f,e,c)}if(h&&h.type==ShareTabType.shareToEMail){g.href=String.format(h.urlFormat,f,e,c,d,a)}}.bind(this))}});var ShareNewsCommentControl=Class.create();Object.extend(ShareNewsCommentControl.prototype,ShareControlBase.prototype);Object.extend(ShareNewsCommentControl.prototype,{name:"ShareNewsCommentControl",relatedObjType:MtimeShareRelatedObjectTypes.CMSNews,shareRelatedObjType:ShareRelatedObjectTypes.NewsComment,isPicNews:false,isAjaxData:false,options:Object.extend(Object.extend({},ShareControlBase.prototype.options),{newsId:0,commentContext:"",newsTitle:"",newsUrl:"",shareInfo:{isLogin:null,needAdditionalInfo:true}}),renderWebShareLinks:function(){ShareControlBase.prototype.renderWebShareLinks.apply(this);this.middleShareClassName="infoshare"},getMiddleShareHtml:function(){var b=[];var a=this.newsTitle;if(a.bytelength()>this.EXCERPT_SIZE*2){a=a.substr(0,this.EXCERPT_SIZE)+"..."}b.push('<h2><a target="_blank" href="'+this.getShareObjectUrl()+'">'+a+"</a></h2>");return b.join("")},shareMtimeContent:function(){return this.commentContext},getShareObjectUrl:function(){return this.newsUrl},getShareObjectTitle:function(){return"<"+this.commentContext+"> 评：新闻 【"+this.newsTitle+"】 <"+this.newsUrl+">"},getShareObjectId:function(){return this.newsId},getShareExpandId:function(){return 0},getShareObjectMailTitle:function(){return this.newsTitle},getShareObjectDefaultRecommendContent:function(c){var b="新闻评论分享："+this.getShareObjectMailTitle();var a=this.getShareObjectTitle();if(c==="subject"){return b}else{return a}},render:function(){var f=this.getShareObjectUrl();var e=this.getShareObjectTitle();var c="";var d=encodeURIComponent(this.getShareObjectDefaultRecommendContent("subject"));var a=encodeURIComponent(this.getShareObjectDefaultRecommendContent("body"));if(this.getShareObjectPicUrl()){c=this.getShareObjectPicUrl()}var b=this.shareContainer.getElementsBySelector("a").each(function(g){var i=g.readAttribute("method");var h=this.ButtonInfoMap[i];if(h&&h.type==ShareTabType.shareToWeb){g.href=String.format(h.urlFormat,f,e,c)}if(h&&h.type==ShareTabType.shareToEMail){g.href=String.format(h.urlFormat,f,e,c,d,a)}}.bind(this))}});var ShareVideoMovieCommentControl=Class.create();Object.extend(ShareVideoMovieCommentControl.prototype,ShareControlBase.prototype);Object.extend(ShareVideoMovieCommentControl.prototype,{name:"ShareVideoMovieCommentControl",relatedObjType:MtimeShareRelatedObjectTypes.Video,shareRelatedObjType:ShareRelatedObjectTypes.VideoMovieComment,options:Object.extend(Object.extend({},ShareControlBase.prototype.options),{videoId:0,commentContext:""}),getMiddleShareHtml:function(){var a=[];a.push('<div class="picmid"><a title="'+this.shareInfo.videoTitleName+'" target="_blank" href="'+this.getShareObjectUrl()+'"><img alt="'+this.shareInfo.videoTitleName+'" src="'+this.shareInfo.specificVideoUrl+'" /><i class="i_share_video">&nbsp;</i><i class="i_share_mask">&nbsp;</i></a></div>');a.push('<div class="txtmid"><h2><a target="_blank" href="'+this.getShareObjectUrl()+'">'+this.shareInfo.videoTitleName+"</a></h2><p>"+this.shareInfo.videoName+"</p></div>");return a.join("")},shareMtimeContent:function(){return this.commentContext},getShareObjectUrl:function(){return this.shareInfo.videoLink},getShareObjectTitle:function(){return this.shareInfo.title},getShareObjectId:function(){return this.videoId},getShareExpandId:function(){return 0},getShareExpandContext:function(){return encodeURIComponent(this.commentContext)},getShareObjectMailTitle:function(){return this.shareInfo.mailTitle},getShareObjectDefaultRecommendContent:function(c){var b="分享视频评论："+this.getShareObjectMailTitle();var a=this.getShareObjectTitle();if(c==="subject"){return b}else{return a}}});var ShareVideoPersonCommentControl=Class.create();Object.extend(ShareVideoPersonCommentControl.prototype,ShareControlBase.prototype);Object.extend(ShareVideoPersonCommentControl.prototype,{name:"ShareVideoPersonCommentControl",relatedObjType:MtimeShareRelatedObjectTypes.Video,shareRelatedObjType:ShareRelatedObjectTypes.VideoPersonComment,options:Object.extend(Object.extend({},ShareControlBase.prototype.options),{videoId:0,personId:0,commentContext:""}),getMiddleShareHtml:function(){var a=[];a.push('<div class="picmid"><a title="'+this.shareInfo.videoTitleName+'" target="_blank" href="'+this.getShareObjectUrl()+'"><img alt="'+this.shareInfo.videoTitleName+'" src="'+this.shareInfo.specificVideoUrl+'" /><i class="i_share_video">&nbsp;</i><i class="i_share_mask">&nbsp;</i></a></div>');a.push('<div class="txtmid"><h2><a target="_blank" href="'+this.getShareObjectUrl()+'">'+this.shareInfo.videoTitleName+"</a></h2><p>"+this.shareInfo.videoName+"</p></div>");return a.join("")},shareMtimeContent:function(){return this.commentContext},getShareObjectUrl:function(){return this.shareInfo.videoLink},getShareObjectTitle:function(){return this.shareInfo.title},getShareObjectId:function(){return this.videoId},getShareExpandId:function(){return this.personId},getShareExpandContext:function(){return encodeURIComponent(this.commentContext)},getShareObjectMailTitle:function(){return this.shareInfo.mailTitle},getShareObjectDefaultRecommendContent:function(c){var b="分享视频评论："+this.getShareObjectMailTitle();var a=this.getShareObjectTitle();if(c==="subject"){return b}else{return a}}});var ShareSCMGoodsCommentControl=Class.create();Object.extend(ShareSCMGoodsCommentControl.prototype,ShareControlBase.prototype);Object.extend(ShareSCMGoodsCommentControl.prototype,{name:"ShareSCMGoodsCommentControl",relatedObjType:MtimeShareRelatedObjectTypes.SCMGoodsComment,isAjaxData:false,options:Object.extend(Object.extend({},ShareControlBase.prototype.options),{goodsName:"",commentText:"",link:"",goodsImageUrl:"",shareInfo:{isLogin:null,needAdditionalInfo:false}}),getMiddleShareHtml:function(){var a=[];var b=this.goodsImageUrl.substring(0,this.goodsImageUrl.lastIndexOf("."))+"_160X160";b+=this.goodsImageUrl.substring(this.goodsImageUrl.lastIndexOf("."));a.push('<div class="picmid"><a title="'+this.goodsName+'" target="_blank" href="'+this.link+'"><img alt="'+this.goodsName+'" src="'+b+'" /></a></div>');a.push('<div class="txtmid"><h2><a target="_blank" href="'+this.link+'">'+this.goodsName+"</a></h2></div>");return a.join("")},shareMtimeContent:function(){return"【商品】"+this.goodsName+': "'+this.commentText+'" '+this.link},getShareObjectUrl:function(){return this.link},getShareObjectTitle:function(){return this.goodsName+': "'+this.commentText+'" '+this.link},getShareObjectMailTitle:function(){return"商品评论分享："+this.goodsName},getShareObjectId:function(){return 0},getShareObjectPicUrl:function(){return this.goodsImageUrl},getShareObjectDefaultRecommendContent:function(c){var b=this.getShareObjectMailTitle();var a=this.getShareObjectTitle();if(c==="subject"){return b}else{return a}},serverLinkControl:{recommendLinkToShare:function(d,e,c,b,a){if(typeof(siteCommunityServiceUrl)!="undefined"){return Mtime.Component.Ajax.crossDomainCallBack(siteCommunityServiceUrl,"Mtime.Community.Services.CommunityService","RecommendLinkToShare",[d,e,c,b],a,"/community.api?Ajax_CallBack=true","get","20000")}}},onSaveShareCallback:function(a){if(typeof recommendLinkToShareResult!=="undefined"){a(recommendLinkToShareResult)}},saveShareInternal:function(b,a,c){this.serverLinkControl.recommendLinkToShare(this.goodsName,this.link,b,this.desc,a)},render:function(){var f=this.getShareObjectUrl();var e=this.getShareObjectTitle();var c="";var d=encodeURIComponent(this.getShareObjectDefaultRecommendContent("subject"));var a=encodeURIComponent(this.getShareObjectDefaultRecommendContent("body"));if(this.getShareObjectPicUrl()){c=this.getShareObjectPicUrl()}var b=this.shareContainer.getElementsBySelector("a").each(function(g){var i=g.readAttribute("method");var h=this.ButtonInfoMap[i];if(h&&h.type==ShareTabType.shareToWeb){g.href=String.format(h.urlFormat,f,e,c)}if(h&&h.type==ShareTabType.shareToEMail){g.href=String.format(h.urlFormat,f,e,c,d,a)}}.bind(this))}});var ShareSCMGoodsDetailControl=Class.create();Object.extend(ShareSCMGoodsDetailControl.prototype,ShareControlBase.prototype);Object.extend(ShareSCMGoodsDetailControl.prototype,{name:"ShareSCMGoodsDetailControl",relatedObjType:MtimeShareRelatedObjectTypes.SCMGoodsComment,isAjaxData:false,options:Object.extend(Object.extend({},ShareControlBase.prototype.options),{goodsName:"",link:"",goodsImageUrl:"",desc:"",shareInfo:{isLogin:null,needAdditionalInfo:false}}),ButtonInfoMap:$H({toSinaMicroblogging:{name:"toSinaMicroblogging",shareClassName:"sinaweibo",text:"新浪微博",type:ShareTabType.shareToWeb,urlFormat:"javascript:GlobalSiteShare('http://service.t.sina.com.cn/share/share.php?appkey=166678827&pic={2}&ralateUid=1663735900&url={0}&title={1}');"},toQQ:{name:"toQQ",shareClassName:"qq",text:"QQ",type:ShareTabType.shareToWeb,urlFormat:"javascript:GlobalSiteShare('http://connect.qq.com/widget/shareqq/index.html?url={0}&desc={3}&title={1}&summary={4}&pics={2}&flash=&site=http://www.mtime.com');"},toQzone:{name:"toQzone",shareClassName:"qzone",text:"QQ空间",type:ShareTabType.shareToWeb,urlFormat:"javascript:GlobalSiteShare('http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url={0}&desc={3}&title={1}&pics={2}&summary={4}');"},toTencentMicroblogging:{name:"toTencentMicroblogging",shareClassName:"qqweibo",text:"腾讯微博",type:ShareTabType.shareToWeb,urlFormat:"javascript:GlobalSiteShare('http://v.t.qq.com/share/share.php?url={0}&appkey=351dd60cf63a48429932e971ca31e87c&site=http://www.mtime.com&pic={2}&title={1}');"},toEMail:{name:"toEMail",shareClassName:"email",text:"电子邮件",type:ShareTabType.shareToEMail,urlFormat:"mailto:?subject={5}&body={6}"},toMtime:{name:"toMtime",shareClassName:"mytime",text:"我的时光",type:ShareTabType.shareToMtimeFriend}}),getMiddleShareHtml:function(){var a=[];var b=this.goodsImageUrl.substring(0,this.goodsImageUrl.lastIndexOf("."))+"_160X160";b+=this.goodsImageUrl.substring(this.goodsImageUrl.lastIndexOf("."));a.push('<div class="picmid"><a title="'+this.goodsName+'" target="_blank" href="'+this.link+'"><img alt="'+this.goodsName+'" src="'+b+'" /></a></div>');a.push('<div class="txtmid"><h2><a target="_blank" href="'+this.link+'">'+this.goodsName+"</a></h2></div>");return a.join("")},shareMtimeContent:function(){return this.goodsName+" | "+this.desc},onClickShareButton:function(b){var a=Event.findElement(b,"dd");this.callback&&this.callback(a);if(a.hasClassName("on")){a.removeClassName("on");if(this.shareContainer){this.shareContainer.hide()}}else{if(a.hasClassName("notcurr")){a.removeClassName("notcurr")}a.addClassName("on");if(this.shareContainer){this.shareContainer.show()}}Event.stop(b)},getShareObjectUrl:function(){return this.link},getShareObjectTitle:function(){return this.goodsName+" | "+this.desc+" | 时光商城"},getShareObjectMailTitle:function(){return"分享商品："+this.goodsName},getShareObjectId:function(){return 0},getShareObjectPicUrl:function(){return this.goodsImageUrl},getShareObjectDefaultRecommendContent:function(c){var b=this.getShareObjectMailTitle();var a="分享商品： "+this.getShareObjectTitle()+" "+this.getShareObjectUrl();if(c==="subject"){return b}else{return a}},serverLinkControl:{recommendLinkToShare:function(d,e,c,b,a){if(typeof(siteCommunityServiceUrl)!="undefined"){return Mtime.Component.Ajax.crossDomainCallBack(siteCommunityServiceUrl,"Mtime.Community.Services.CommunityService","RecommendLinkToShare",[d,e,c,b],a,"/community.api?Ajax_CallBack=true","get","20000")}}},onSaveShareCallback:function(a){if(typeof recommendLinkToShareResult!=="undefined"){a(recommendLinkToShareResult)}},saveShareInternal:function(b,a,c){this.serverLinkControl.recommendLinkToShare(this.goodsName,this.link,b,this.desc,a)},render:function(){var h=this.getShareObjectUrl();var g=this.getShareObjectTitle();var e="";var d=this.goodsName;var c=this.desc;var f=encodeURIComponent(this.getShareObjectDefaultRecommendContent("subject"));var a=encodeURIComponent(this.getShareObjectDefaultRecommendContent("body"));if(this.getShareObjectPicUrl()){e=this.getShareObjectPicUrl()}var b=this.shareContainer.getElementsBySelector("a").each(function(i){var k=i.readAttribute("method");var j=this.ButtonInfoMap[k];if(j&&j.type==ShareTabType.shareToWeb){if(k=="toSinaMicroblogging"||k=="toTencentMicroblogging"){i.href=String.format(j.urlFormat,h,g,e)}else{i.href=String.format(j.urlFormat,h,d,e,g,c)}}if(j&&j.type==ShareTabType.shareToEMail){i.href=String.format(j.urlFormat,h,d,e,g,c,f,a)}}.bind(this))}});var ShareControlManager=Class.create();Object.extend(ShareControlManager.prototype,{controls:null,initialize:function(){this.controls=[]},swtichNewControl:function(a,d){var b=parseInt(a.shareRelatedObjType,10);var c;switch(b){case ShareRelatedObjectTypes.Movie:c=new ShareMovieControl({shareControlStyleType:d,movieId:a.relatedId,shareButton:a.shareButton,shareContainer:a.shareContainer,autoLoad:false,callback:a.callback,shareSuccessCallBack:a.shareSuccessCallBack});break;case ShareRelatedObjectTypes.MovieIsReleased:c=new ShareMovieIsReleasedControl({shareControlStyleType:d,movieId:a.relatedId,shareButton:a.shareButton,shareContainer:a.shareContainer,autoLoad:false,callback:a.callback,shareSuccessCallBack:a.shareSuccessCallBack});break;case ShareRelatedObjectTypes.MovieUpcoming:c=new ShareMovieUpcomingControl({shareControlStyleType:d,movieId:a.relatedId,shareButton:a.shareButton,shareContainer:a.shareContainer,autoLoad:false,callback:a.callback,shareSuccessCallBack:a.shareSuccessCallBack});break;case ShareRelatedObjectTypes.MovieHasAwards:c=new ShareMovieHasAwardsControl({shareControlStyleType:d,movieId:a.relatedId,shareButton:a.shareButton,shareContainer:a.shareContainer,autoLoad:false,callback:a.callback,shareSuccessCallBack:a.shareSuccessCallBack});break;case ShareRelatedObjectTypes.MovieGeneral:c=new ShareMovieGeneralControl({shareControlStyleType:d,movieId:a.relatedId,shareButton:a.shareButton,shareContainer:a.shareContainer,autoLoad:false,callback:a.callback,shareSuccessCallBack:a.shareSuccessCallBack});break;case ShareRelatedObjectTypes.MovieContentPlot:c=new ShareMovieContentPlotControl({shareControlStyleType:d,movieParagraphId:a.relatedId,shareButton:a.shareButton,shareContainer:a.shareContainer,expandMovieId:a.expandMovieId,autoLoad:false,callback:a.callback,shareSuccessCallBack:a.shareSuccessCallBack});break;case ShareRelatedObjectTypes.MovieRoleDescInfo:c=new ShareMovieRoleDescInfoControl({shareControlStyleType:d,movieRoleId:a.relatedId,shareButton:a.shareButton,shareContainer:a.shareContainer,expandMovieId:a.expandMovieId,autoLoad:false,callback:a.callback,shareSuccessCallBack:a.shareSuccessCallBack});break;case ShareRelatedObjectTypes.MovieRoleDescAll:c=new ShareMovieRoleDescAllControl({shareControlStyleType:d,movieId:a.relatedId,shareButton:a.shareButton,shareContainer:a.shareContainer,autoLoad:false,callback:a.callback,shareSuccessCallBack:a.shareSuccessCallBack});break;case ShareRelatedObjectTypes.MovieBehindCurtain:c=new ShareMovieBehindCurtainControl({shareControlStyleType:d,behindSectionID:a.relatedId,screenshotImageUrl:a.screenshotImageUrl,shareButton:a.shareButton,shareContainer:a.shareContainer,expandMovieId:a.expandMovieId,autoLoad:false,callback:a.callback,shareSuccessCallBack:a.shareSuccessCallBack});break;case ShareRelatedObjectTypes.MovieVerseLines:c=new ShareMovieVerseLinesControl({shareControlStyleType:d,behindSectionID:a.relatedId,screenshotImageUrl:a.screenshotImageUrl,shareButton:a.shareButton,shareContainer:a.shareContainer,expandMovieId:a.expandMovieId,autoLoad:false,callback:a.callback,shareSuccessCallBack:a.shareSuccessCallBack});break;case ShareRelatedObjectTypes.MovieBehindTemplate:c=new ShareMovieBehindTemplateControl({shareControlStyleType:d,title:a.title,link:a.link,pic:a.pic,desc:a.desc,movieId:a.relatedId,shareButton:a.shareButton,shareContainer:a.shareContainer,expandMovieId:a.expandMovieId,autoLoad:false,callback:a.callback,shareSuccessCallBack:a.shareSuccessCallBack});break;case ShareRelatedObjectTypes.MovieTelecinePage:c=new ShareMovieTelecinePageControl({shareControlStyleType:d,shareButton:a.shareButton,shareContainer:a.shareContainer,movieTitle:a.movieTitle,cityName:a.cityName,imageUrl:a.imageUrl,date:a.date,link:a.link,autoLoad:false,callback:a.callback,shareSuccessCallBack:a.shareSuccessCallBack});break;case ShareRelatedObjectTypes.PersonFavorableComment:c=new SharePersonFavorableCommentControl({shareControlStyleType:d,personId:a.relatedId,shareButton:a.shareButton,shareContainer:a.shareContainer,autoLoad:false,callback:a.callback,shareSuccessCallBack:a.shareSuccessCallBack});break;case ShareRelatedObjectTypes.News:c=new ShareNewsControl({shareControlStyleType:d,newsId:a.relatedId,shareButton:a.shareButton,shareContainer:a.shareContainer,autoLoad:false,callback:a.callback,shareSuccessCallBack:a.shareSuccessCallBack});break;case ShareRelatedObjectTypes.ImageNews:c=new ShareImageNewsControl({shareControlStyleType:d,imageId:a.relatedId,shareButton:a.shareButton,shareContainer:a.shareContainer,autoLoad:false,callback:a.callback,shareSuccessCallBack:a.shareSuccessCallBack});break;case ShareRelatedObjectTypes.MovieLongComment:c=new ShareMovieLongCommentControl({shareControlStyleType:d,blogId:a.relatedId,urlTypeId:a.expandId,shareButton:a.shareButton,shareContainer:a.shareContainer,autoLoad:false,callback:a.callback,shareSuccessCallBack:a.shareSuccessCallBack});break;case ShareRelatedObjectTypes.MovieShortComment:c=new ShareMovieShortCommentControl({shareControlStyleType:d,tweetId:a.relatedId,shareButton:a.shareButton,shareContainer:a.shareContainer,autoLoad:false,callback:a.callback,shareSuccessCallBack:a.shareSuccessCallBack});break;case ShareRelatedObjectTypes.MovieLeaveComment:c=new ShareMovieLeaveCommentControl({shareControlStyleType:d,tweetId:a.relatedId,shareButton:a.shareButton,shareContainer:a.shareContainer,autoLoad:false,callback:a.callback,shareSuccessCallBack:a.shareSuccessCallBack});break;case ShareRelatedObjectTypes.VideoMovie:c=new ShareVideoMovieControl({shareControlStyleType:d,videoId:a.relatedId,shareButton:a.shareButton,shareContainer:a.shareContainer,autoLoad:false,callback:a.callback,shareSuccessCallBack:a.shareSuccessCallBack});break;case ShareRelatedObjectTypes.VideoPerson:c=new ShareVideoPersonControl({shareControlStyleType:d,videoId:a.relatedId,personId:a.expandId,shareButton:a.shareButton,shareContainer:a.shareContainer,autoLoad:false,callback:a.callback,shareSuccessCallBack:a.shareSuccessCallBack});break;case ShareRelatedObjectTypes.PictureMovie:c=new SharePictureMovieControl({shareControlStyleType:d,imageId:a.relatedId,shareButton:a.shareButton,shareContainer:a.shareContainer,desc:a.desc,autoLoad:false,callback:a.callback,shareSuccessCallBack:a.shareSuccessCallBack});break;case ShareRelatedObjectTypes.PicturePerson:c=new SharePicturePersonControl({shareControlStyleType:d,imageId:a.relatedId,personId:a.expandId,shareButton:a.shareButton,shareContainer:a.shareContainer,desc:a.desc,autoLoad:false,callback:a.callback,shareSuccessCallBack:a.shareSuccessCallBack});break;case ShareRelatedObjectTypes.Cinema:c=new ShareCinemaControl({shareControlStyleType:d,cinemaId:a.relatedId,date:a.date,shareButton:a.shareButton,shareContainer:a.shareContainer,autoLoad:false,callback:a.callback,shareSuccessCallBack:a.shareSuccessCallBack});break;case ShareRelatedObjectTypes.IndexNewsTop:c=new ShareUniversalControl({shareControlStyleType:d,newsId:a.relatedId,title:a.title,fullTitle:a.fullTitle,link:a.link,pic:a.pic,desc:a.desc,shareButton:a.shareButton,shareContainer:a.shareContainer,autoLoad:false,callback:a.callback,shareSuccessCallBack:a.shareSuccessCallBack});break;case ShareRelatedObjectTypes.Blog:c=new ShareBlogControl({shareControlStyleType:d,blogId:a.relatedId,shareButton:a.shareButton,shareContainer:a.shareContainer,autoLoad:false,callback:a.callback,shareSuccessCallBack:a.shareSuccessCallBack});break;case ShareRelatedObjectTypes.ForumTopic:c=new ShareForumTopicControl({shareControlStyleType:d,topicId:a.relatedId,shareButton:a.shareButton,shareContainer:a.shareContainer,autoLoad:false,callback:a.callback,shareSuccessCallBack:a.shareSuccessCallBack});break;case ShareRelatedObjectTypes.Activity:c=new ShareActivityControl({shareControlStyleType:d,activityId:a.relatedId,shareButton:a.shareButton,shareContainer:a.shareContainer,autoLoad:false,callback:a.callback,shareSuccessCallBack:a.shareSuccessCallBack});break;case ShareRelatedObjectTypes.MediaReview:c=new ShareMediaReviewControl({shareControlStyleType:d,mediaReviewId:a.relatedId,shareButton:a.shareButton,shareContainer:a.shareContainer,expandMovieId:a.expandMovieId,autoLoad:false,callback:a.callback,shareSuccessCallBack:a.shareSuccessCallBack});break;case ShareRelatedObjectTypes.Link:c=new ShareLinkControl({shareControlStyleType:d,title:a.title,link:a.link,pic:a.pic,desc:a.desc,shareButton:a.shareButton,shareContainer:a.shareContainer,autoLoad:false,callback:a.callback,shareSuccessCallBack:a.shareSuccessCallBack});break;case ShareRelatedObjectTypes.OffsiteLink:c=new ShareOffsiteLinkControl({title:a.title,link:a.link,pic:a.pic,desc:a.desc,shareContainer:a.shareContainer,autoLoad:false,callback:a.callback,shareSuccessCallBack:a.shareSuccessCallBack});break;case ShareRelatedObjectTypes.GoodsDetail:c=new ShareGoodsDetailControl({shareControlStyleType:d,title:a.title,link:a.link,pic:a.pic,shareButton:a.shareButton,shareContainer:a.shareContainer,autoLoad:false,callback:a.callback,shareSuccessCallBack:a.shareSuccessCallBack});break;case ShareRelatedObjectTypes.SCMGoodsDetail:c=new ShareSCMGoodsDetailControl({shareControlStyleType:d,goodsName:a.title,link:a.link,goodsImageUrl:a.pic,desc:a.desc,shareButton:a.shareButton,shareContainer:a.shareContainer,autoLoad:false,callback:a.callback,shareSuccessCallBack:a.shareSuccessCallBack});break;default:break}return c},initShareControl:function(a){var b=[];a.each(function(c){var d;var e=ShareControlStyleType.FloatStyle;if(c.shareControlStyleType){e=c.shareControlStyleType}var f=parseInt(c.shareRelatedObjType,10);var g=this;var d=g.swtichNewControl(c,e);if(d){this.controls.push(d);b.push(d)}}.bind(this));return b},destroyControl:function(){this.controls.each(function(a){a.close()});this.controls=null},close:function(){if(!this.closed){this.closed=true;this.destroyControl()}}});function EmailIframe(b){var a=document.createElement("iframe");a.style.display="none";a.style.width="0px";a.style.height="0px";a.src=b;document.body.appendChild(a);setTimeout(function(){document.body.removeChild(a)},8000)}function GlobalSiteShare(n){if(GlobalUrlValue!==""){n=GlobalUrlValue;GlobalUrlValue=""}var c=n.indexOf("?");if(c>0){var k=n.substring(c);var g=n.substring(0,c);var b=[];var m=k.substring(1);var h=m.split("&");for(var e=0;e<h.length;e++){var l=h[e].indexOf("=");if(l==-1){continue}var a=h[e].substring(0,l);var o=h[e].substring(l+1);o=o.replace(/\^PIC\^/g,encodeURIComponent("&"));b.push({key:a,value:decodeURIComponent(o)})}var d=null;if(b.length>0){d=g+"?";for(var f=0;f<b.length;f++){if(f!=0){d+="&"}d+=b[f].key+"="+encodeURIComponent(b[f].value)}}if(d!=null){n=d}}window.open(n)};